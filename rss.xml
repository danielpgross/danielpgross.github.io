<?xml version="1.0" encoding="UTF-8"?><rss xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:content="http://purl.org/rss/1.0/modules/content/" xmlns:atom="http://www.w3.org/2005/Atom" version="2.0"><channel><title><![CDATA[Minimal Blog - @lekoarts/gatsby-theme-minimal-blog]]></title><description><![CDATA[Daniel P. Gross is a computer software and hardware professional based in Toronto.]]></description><link>https://dgross.ca</link><generator>GatsbyJS</generator><lastBuildDate>Wed, 24 Mar 2021 15:43:38 GMT</lastBuildDate><item><title><![CDATA[Is this thing still on?]]></title><link>https://dgross.ca/blog/is-this-thing-still-on</link><guid isPermaLink="false">https://dgross.ca/blog/is-this-thing-still-on</guid><pubDate>Tue, 24 Nov 2020 05:00:00 GMT</pubDate><content:encoded>&lt;style data-emotion-css=&quot;9096aj&quot;&gt;body{--theme-ui-colors-transparent:var(--theme-ui-colors-transparent,transparent);--theme-ui-colors-black:var(--theme-ui-colors-black,#000);--theme-ui-colors-white:var(--theme-ui-colors-white,#fff);--theme-ui-colors-gray-0:var(--theme-ui-colors-gray-0,null);--theme-ui-colors-gray-1:var(--theme-ui-colors-gray-1,#f7fafc);--theme-ui-colors-gray-2:var(--theme-ui-colors-gray-2,#edf2f7);--theme-ui-colors-gray-3:var(--theme-ui-colors-gray-3,#e2e8f0);--theme-ui-colors-gray-4:var(--theme-ui-colors-gray-4,#cbd5e0);--theme-ui-colors-gray-5:var(--theme-ui-colors-gray-5,#a0aec0);--theme-ui-colors-gray-6:var(--theme-ui-colors-gray-6,#718096);--theme-ui-colors-gray-7:var(--theme-ui-colors-gray-7,#4a5568);--theme-ui-colors-gray-8:var(--theme-ui-colors-gray-8,#2d3748);--theme-ui-colors-gray-9:var(--theme-ui-colors-gray-9,#1a202c);--theme-ui-colors-red-0:var(--theme-ui-colors-red-0,null);--theme-ui-colors-red-1:var(--theme-ui-colors-red-1,#fff5f5);--theme-ui-colors-red-2:var(--theme-ui-colors-red-2,#fed7d7);--theme-ui-colors-red-3:var(--theme-ui-colors-red-3,#feb2b2);--theme-ui-colors-red-4:var(--theme-ui-colors-red-4,#fc8181);--theme-ui-colors-red-5:var(--theme-ui-colors-red-5,#f56565);--theme-ui-colors-red-6:var(--theme-ui-colors-red-6,#e53e3e);--theme-ui-colors-red-7:var(--theme-ui-colors-red-7,#c53030);--theme-ui-colors-red-8:var(--theme-ui-colors-red-8,#9b2c2c);--theme-ui-colors-red-9:var(--theme-ui-colors-red-9,#742a2a);--theme-ui-colors-orange-0:var(--theme-ui-colors-orange-0,null);--theme-ui-colors-orange-1:var(--theme-ui-colors-orange-1,#fffaf0);--theme-ui-colors-orange-2:var(--theme-ui-colors-orange-2,#feebc8);--theme-ui-colors-orange-3:var(--theme-ui-colors-orange-3,#fbd38d);--theme-ui-colors-orange-4:var(--theme-ui-colors-orange-4,#f6ad55);--theme-ui-colors-orange-5:var(--theme-ui-colors-orange-5,#ed8936);--theme-ui-colors-orange-6:var(--theme-ui-colors-orange-6,#dd6b20);--theme-ui-colors-orange-7:var(--theme-ui-colors-orange-7,#c05621);--theme-ui-colors-orange-8:var(--theme-ui-colors-orange-8,#9c4221);--theme-ui-colors-orange-9:var(--theme-ui-colors-orange-9,#7b341e);--theme-ui-colors-yellow-0:var(--theme-ui-colors-yellow-0,null);--theme-ui-colors-yellow-1:var(--theme-ui-colors-yellow-1,#fffff0);--theme-ui-colors-yellow-2:var(--theme-ui-colors-yellow-2,#fefcbf);--theme-ui-colors-yellow-3:var(--theme-ui-colors-yellow-3,#faf089);--theme-ui-colors-yellow-4:var(--theme-ui-colors-yellow-4,#f6e05e);--theme-ui-colors-yellow-5:var(--theme-ui-colors-yellow-5,#ecc94b);--theme-ui-colors-yellow-6:var(--theme-ui-colors-yellow-6,#d69e2e);--theme-ui-colors-yellow-7:var(--theme-ui-colors-yellow-7,#b7791f);--theme-ui-colors-yellow-8:var(--theme-ui-colors-yellow-8,#975a16);--theme-ui-colors-yellow-9:var(--theme-ui-colors-yellow-9,#744210);--theme-ui-colors-green-0:var(--theme-ui-colors-green-0,null);--theme-ui-colors-green-1:var(--theme-ui-colors-green-1,#f0fff4);--theme-ui-colors-green-2:var(--theme-ui-colors-green-2,#c6f6d5);--theme-ui-colors-green-3:var(--theme-ui-colors-green-3,#9ae6b4);--theme-ui-colors-green-4:var(--theme-ui-colors-green-4,#68d391);--theme-ui-colors-green-5:var(--theme-ui-colors-green-5,#48bb78);--theme-ui-colors-green-6:var(--theme-ui-colors-green-6,#38a169);--theme-ui-colors-green-7:var(--theme-ui-colors-green-7,#2f855a);--theme-ui-colors-green-8:var(--theme-ui-colors-green-8,#276749);--theme-ui-colors-green-9:var(--theme-ui-colors-green-9,#22543d);--theme-ui-colors-teal-0:var(--theme-ui-colors-teal-0,null);--theme-ui-colors-teal-1:var(--theme-ui-colors-teal-1,#e6fffa);--theme-ui-colors-teal-2:var(--theme-ui-colors-teal-2,#b2f5ea);--theme-ui-colors-teal-3:var(--theme-ui-colors-teal-3,#81e6d9);--theme-ui-colors-teal-4:var(--theme-ui-colors-teal-4,#4fd1c5);--theme-ui-colors-teal-5:var(--theme-ui-colors-teal-5,#38b2ac);--theme-ui-colors-teal-6:var(--theme-ui-colors-teal-6,#319795);--theme-ui-colors-teal-7:var(--theme-ui-colors-teal-7,#2c7a7b);--theme-ui-colors-teal-8:var(--theme-ui-colors-teal-8,#285e61);--theme-ui-colors-teal-9:var(--theme-ui-colors-teal-9,#234e52);--theme-ui-colors-blue-0:var(--theme-ui-colors-blue-0,null);--theme-ui-colors-blue-1:var(--theme-ui-colors-blue-1,#ebf8ff);--theme-ui-colors-blue-2:var(--theme-ui-colors-blue-2,#bee3f8);--theme-ui-colors-blue-3:var(--theme-ui-colors-blue-3,#90cdf4);--theme-ui-colors-blue-4:var(--theme-ui-colors-blue-4,#63b3ed);--theme-ui-colors-blue-5:var(--theme-ui-colors-blue-5,#4299e1);--theme-ui-colors-blue-6:var(--theme-ui-colors-blue-6,#3182ce);--theme-ui-colors-blue-7:var(--theme-ui-colors-blue-7,#2b6cb0);--theme-ui-colors-blue-8:var(--theme-ui-colors-blue-8,#2c5282);--theme-ui-colors-blue-9:var(--theme-ui-colors-blue-9,#2a4365);--theme-ui-colors-indigo-0:var(--theme-ui-colors-indigo-0,null);--theme-ui-colors-indigo-1:var(--theme-ui-colors-indigo-1,#ebf4ff);--theme-ui-colors-indigo-2:var(--theme-ui-colors-indigo-2,#c3dafe);--theme-ui-colors-indigo-3:var(--theme-ui-colors-indigo-3,#a3bffa);--theme-ui-colors-indigo-4:var(--theme-ui-colors-indigo-4,#7f9cf5);--theme-ui-colors-indigo-5:var(--theme-ui-colors-indigo-5,#667eea);--theme-ui-colors-indigo-6:var(--theme-ui-colors-indigo-6,#5a67d8);--theme-ui-colors-indigo-7:var(--theme-ui-colors-indigo-7,#4c51bf);--theme-ui-colors-indigo-8:var(--theme-ui-colors-indigo-8,#434190);--theme-ui-colors-indigo-9:var(--theme-ui-colors-indigo-9,#3c366b);--theme-ui-colors-purple-0:var(--theme-ui-colors-purple-0,null);--theme-ui-colors-purple-1:var(--theme-ui-colors-purple-1,#faf5ff);--theme-ui-colors-purple-2:var(--theme-ui-colors-purple-2,#e9d8fd);--theme-ui-colors-purple-3:var(--theme-ui-colors-purple-3,#d6bcfa);--theme-ui-colors-purple-4:var(--theme-ui-colors-purple-4,#b794f4);--theme-ui-colors-purple-5:var(--theme-ui-colors-purple-5,#9f7aea);--theme-ui-colors-purple-6:var(--theme-ui-colors-purple-6,#805ad5);--theme-ui-colors-purple-7:var(--theme-ui-colors-purple-7,#6b46c1);--theme-ui-colors-purple-8:var(--theme-ui-colors-purple-8,#553c9a);--theme-ui-colors-purple-9:var(--theme-ui-colors-purple-9,#44337a);--theme-ui-colors-pink-0:var(--theme-ui-colors-pink-0,null);--theme-ui-colors-pink-1:var(--theme-ui-colors-pink-1,#fff5f7);--theme-ui-colors-pink-2:var(--theme-ui-colors-pink-2,#fed7e2);--theme-ui-colors-pink-3:var(--theme-ui-colors-pink-3,#fbb6ce);--theme-ui-colors-pink-4:var(--theme-ui-colors-pink-4,#f687b3);--theme-ui-colors-pink-5:var(--theme-ui-colors-pink-5,#ed64a6);--theme-ui-colors-pink-6:var(--theme-ui-colors-pink-6,#d53f8c);--theme-ui-colors-pink-7:var(--theme-ui-colors-pink-7,#b83280);--theme-ui-colors-pink-8:var(--theme-ui-colors-pink-8,#97266d);--theme-ui-colors-pink-9:var(--theme-ui-colors-pink-9,#702459);--theme-ui-colors-grayDark:var(--theme-ui-colors-grayDark,#2d3748);--theme-ui-colors-text:var(--theme-ui-colors-text,#2d3748);--theme-ui-colors-background:var(--theme-ui-colors-background,#fff);--theme-ui-colors-primary:var(--theme-ui-colors-primary,#2b6cb0);--theme-ui-colors-primaryHover:var(--theme-ui-colors-primaryHover,#2c5282);--theme-ui-colors-secondary:var(--theme-ui-colors-secondary,#718096);--theme-ui-colors-muted:var(--theme-ui-colors-muted,#e2e8f0);--theme-ui-colors-success:var(--theme-ui-colors-success,#9ae6b4);--theme-ui-colors-info:var(--theme-ui-colors-info,#63b3ed);--theme-ui-colors-warning:var(--theme-ui-colors-warning,#faf089);--theme-ui-colors-danger:var(--theme-ui-colors-danger,#feb2b2);--theme-ui-colors-light:var(--theme-ui-colors-light,#f7fafc);--theme-ui-colors-dark:var(--theme-ui-colors-dark,#2d3748);--theme-ui-colors-textMuted:var(--theme-ui-colors-textMuted,#718096);--theme-ui-colors-toggleIcon:var(--theme-ui-colors-toggleIcon,#2d3748);--theme-ui-colors-heading:var(--theme-ui-colors-heading,#000);--theme-ui-colors-divide:var(--theme-ui-colors-divide,#cbd5e0);color:var(--theme-ui-colors-text,#2d3748);background-color:var(--theme-ui-colors-background,#fff);}body.theme-ui-dark{--theme-ui-colors-text:var(--theme-ui-colors-modes-dark-text,#cbd5e0);--theme-ui-colors-primary:var(--theme-ui-colors-modes-dark-primary,#63b3ed);--theme-ui-colors-secondary:var(--theme-ui-colors-modes-dark-secondary,#7f8ea3);--theme-ui-colors-toggleIcon:var(--theme-ui-colors-modes-dark-toggleIcon,#cbd5e0);--theme-ui-colors-background:var(--theme-ui-colors-modes-dark-background,#1A202C);--theme-ui-colors-heading:var(--theme-ui-colors-modes-dark-heading,#fff);--theme-ui-colors-divide:var(--theme-ui-colors-modes-dark-divide,#2d3748);--theme-ui-colors-muted:var(--theme-ui-colors-modes-dark-muted,#2d3748);}&lt;/style&gt;&lt;style data-emotion-css=&quot;tm2q0o&quot;&gt;*{box-sizing:border-box;}body{margin:0;font-family:&quot;IBM Plex Sans&quot;,-apple-system,BlinkMacSystemFont,&quot;Segoe UI&quot;,Roboto,&quot;Helvetica Neue&quot;,Arial,&quot;Noto Sans&quot;,sans-serif,&quot;Apple Color Emoji&quot;,&quot;Segoe UI Emoji&quot;,&quot;Segoe UI Symbol&quot;,&quot;Noto Color Emoji&quot;;line-height:1.625;font-weight:400;color:var(--theme-ui-colors-text,#2d3748);background-color:var(--theme-ui-colors-background,#fff);padding:0;box-sizing:border-box;text-rendering:optimizeLegibility;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;}&lt;/style&gt;&lt;style data-emotion-css=&quot;ocxwk4&quot;&gt;.css-ocxwk4{font-size:1rem;-webkit-letter-spacing:-0.003em;-moz-letter-spacing:-0.003em;-ms-letter-spacing:-0.003em;letter-spacing:-0.003em;line-height:1.625;--baseline-multiplier:0.179;--x-height-multiplier:0.35;word-break:break-word;}@media screen and (min-width:640px){.css-ocxwk4{font-size:1rem;}}@media screen and (min-width:768px){.css-ocxwk4{font-size:1.1rem;}}&lt;/style&gt;&lt;p class=&quot;css-ocxwk4&quot;&gt;Hello out there! It&amp;#x27;s been pretty quiet around here for a while now. Life got very busy and I haven&amp;#x27;t had as much time as I&amp;#x27;d like to post new content.&lt;/p&gt;&lt;p class=&quot;css-ocxwk4&quot;&gt;In addition to a bunch of developments in my personal life, I made a career change earlier this year. Following a long search with a few dead ends, I was very fortunate to find a good fit with the &lt;style data-emotion-css=&quot;1i9b1eb&quot;&gt;.css-1i9b1eb{color:var(--theme-ui-colors-primary,#2b6cb0);-webkit-text-decoration:none;text-decoration:none;}.css-1i9b1eb:hover{-webkit-text-decoration:underline;text-decoration:underline;}&lt;/style&gt;&lt;a href=&quot;https://shop.app&quot; class=&quot;css-1i9b1eb&quot;&gt;Shop&lt;/a&gt; team at &lt;a href=&quot;https://www.shopify.ca/&quot; class=&quot;css-1i9b1eb&quot;&gt;Shopify&lt;/a&gt;. This entailed many changes for me: healthcare to commerce, startup to giant, web to mobile development, office to digital by default. Shopify has much more soul than I ever imagined possible for a tech giant, and I&amp;#x27;m proud to be a part of it. As a Development Manager, I spend my time building software (mobile development) and helping people around me grow.&lt;/p&gt;&lt;p class=&quot;css-ocxwk4&quot;&gt;In addition to posting some new content here, I decided it was also time to refresh the visual theme and upgrade the technology hosting this site. The site now runs on &lt;a href=&quot;https://www.gatsbyjs.com/&quot; class=&quot;css-1i9b1eb&quot;&gt;GatsbyJS&lt;/a&gt;, a really cool and powerful static site platform. I hope to publish some content here soon about the process of migrating over to use Gatsby, and some of the lessons I learned. &lt;/p&gt;</content:encoded></item><item><title><![CDATA[Building a battery-powered wireless sensor using Bluetooth Low-Energy (BLE) and Apple HomeKit (Part 3)]]></title><link>https://dgross.ca/blog/ble-homekit-sensor-pt3</link><guid isPermaLink="false">https://dgross.ca/blog/ble-homekit-sensor-pt3</guid><pubDate>Tue, 05 Dec 2017 05:00:00 GMT</pubDate><content:encoded>&lt;style data-emotion-css=&quot;9096aj&quot;&gt;body{--theme-ui-colors-transparent:var(--theme-ui-colors-transparent,transparent);--theme-ui-colors-black:var(--theme-ui-colors-black,#000);--theme-ui-colors-white:var(--theme-ui-colors-white,#fff);--theme-ui-colors-gray-0:var(--theme-ui-colors-gray-0,null);--theme-ui-colors-gray-1:var(--theme-ui-colors-gray-1,#f7fafc);--theme-ui-colors-gray-2:var(--theme-ui-colors-gray-2,#edf2f7);--theme-ui-colors-gray-3:var(--theme-ui-colors-gray-3,#e2e8f0);--theme-ui-colors-gray-4:var(--theme-ui-colors-gray-4,#cbd5e0);--theme-ui-colors-gray-5:var(--theme-ui-colors-gray-5,#a0aec0);--theme-ui-colors-gray-6:var(--theme-ui-colors-gray-6,#718096);--theme-ui-colors-gray-7:var(--theme-ui-colors-gray-7,#4a5568);--theme-ui-colors-gray-8:var(--theme-ui-colors-gray-8,#2d3748);--theme-ui-colors-gray-9:var(--theme-ui-colors-gray-9,#1a202c);--theme-ui-colors-red-0:var(--theme-ui-colors-red-0,null);--theme-ui-colors-red-1:var(--theme-ui-colors-red-1,#fff5f5);--theme-ui-colors-red-2:var(--theme-ui-colors-red-2,#fed7d7);--theme-ui-colors-red-3:var(--theme-ui-colors-red-3,#feb2b2);--theme-ui-colors-red-4:var(--theme-ui-colors-red-4,#fc8181);--theme-ui-colors-red-5:var(--theme-ui-colors-red-5,#f56565);--theme-ui-colors-red-6:var(--theme-ui-colors-red-6,#e53e3e);--theme-ui-colors-red-7:var(--theme-ui-colors-red-7,#c53030);--theme-ui-colors-red-8:var(--theme-ui-colors-red-8,#9b2c2c);--theme-ui-colors-red-9:var(--theme-ui-colors-red-9,#742a2a);--theme-ui-colors-orange-0:var(--theme-ui-colors-orange-0,null);--theme-ui-colors-orange-1:var(--theme-ui-colors-orange-1,#fffaf0);--theme-ui-colors-orange-2:var(--theme-ui-colors-orange-2,#feebc8);--theme-ui-colors-orange-3:var(--theme-ui-colors-orange-3,#fbd38d);--theme-ui-colors-orange-4:var(--theme-ui-colors-orange-4,#f6ad55);--theme-ui-colors-orange-5:var(--theme-ui-colors-orange-5,#ed8936);--theme-ui-colors-orange-6:var(--theme-ui-colors-orange-6,#dd6b20);--theme-ui-colors-orange-7:var(--theme-ui-colors-orange-7,#c05621);--theme-ui-colors-orange-8:var(--theme-ui-colors-orange-8,#9c4221);--theme-ui-colors-orange-9:var(--theme-ui-colors-orange-9,#7b341e);--theme-ui-colors-yellow-0:var(--theme-ui-colors-yellow-0,null);--theme-ui-colors-yellow-1:var(--theme-ui-colors-yellow-1,#fffff0);--theme-ui-colors-yellow-2:var(--theme-ui-colors-yellow-2,#fefcbf);--theme-ui-colors-yellow-3:var(--theme-ui-colors-yellow-3,#faf089);--theme-ui-colors-yellow-4:var(--theme-ui-colors-yellow-4,#f6e05e);--theme-ui-colors-yellow-5:var(--theme-ui-colors-yellow-5,#ecc94b);--theme-ui-colors-yellow-6:var(--theme-ui-colors-yellow-6,#d69e2e);--theme-ui-colors-yellow-7:var(--theme-ui-colors-yellow-7,#b7791f);--theme-ui-colors-yellow-8:var(--theme-ui-colors-yellow-8,#975a16);--theme-ui-colors-yellow-9:var(--theme-ui-colors-yellow-9,#744210);--theme-ui-colors-green-0:var(--theme-ui-colors-green-0,null);--theme-ui-colors-green-1:var(--theme-ui-colors-green-1,#f0fff4);--theme-ui-colors-green-2:var(--theme-ui-colors-green-2,#c6f6d5);--theme-ui-colors-green-3:var(--theme-ui-colors-green-3,#9ae6b4);--theme-ui-colors-green-4:var(--theme-ui-colors-green-4,#68d391);--theme-ui-colors-green-5:var(--theme-ui-colors-green-5,#48bb78);--theme-ui-colors-green-6:var(--theme-ui-colors-green-6,#38a169);--theme-ui-colors-green-7:var(--theme-ui-colors-green-7,#2f855a);--theme-ui-colors-green-8:var(--theme-ui-colors-green-8,#276749);--theme-ui-colors-green-9:var(--theme-ui-colors-green-9,#22543d);--theme-ui-colors-teal-0:var(--theme-ui-colors-teal-0,null);--theme-ui-colors-teal-1:var(--theme-ui-colors-teal-1,#e6fffa);--theme-ui-colors-teal-2:var(--theme-ui-colors-teal-2,#b2f5ea);--theme-ui-colors-teal-3:var(--theme-ui-colors-teal-3,#81e6d9);--theme-ui-colors-teal-4:var(--theme-ui-colors-teal-4,#4fd1c5);--theme-ui-colors-teal-5:var(--theme-ui-colors-teal-5,#38b2ac);--theme-ui-colors-teal-6:var(--theme-ui-colors-teal-6,#319795);--theme-ui-colors-teal-7:var(--theme-ui-colors-teal-7,#2c7a7b);--theme-ui-colors-teal-8:var(--theme-ui-colors-teal-8,#285e61);--theme-ui-colors-teal-9:var(--theme-ui-colors-teal-9,#234e52);--theme-ui-colors-blue-0:var(--theme-ui-colors-blue-0,null);--theme-ui-colors-blue-1:var(--theme-ui-colors-blue-1,#ebf8ff);--theme-ui-colors-blue-2:var(--theme-ui-colors-blue-2,#bee3f8);--theme-ui-colors-blue-3:var(--theme-ui-colors-blue-3,#90cdf4);--theme-ui-colors-blue-4:var(--theme-ui-colors-blue-4,#63b3ed);--theme-ui-colors-blue-5:var(--theme-ui-colors-blue-5,#4299e1);--theme-ui-colors-blue-6:var(--theme-ui-colors-blue-6,#3182ce);--theme-ui-colors-blue-7:var(--theme-ui-colors-blue-7,#2b6cb0);--theme-ui-colors-blue-8:var(--theme-ui-colors-blue-8,#2c5282);--theme-ui-colors-blue-9:var(--theme-ui-colors-blue-9,#2a4365);--theme-ui-colors-indigo-0:var(--theme-ui-colors-indigo-0,null);--theme-ui-colors-indigo-1:var(--theme-ui-colors-indigo-1,#ebf4ff);--theme-ui-colors-indigo-2:var(--theme-ui-colors-indigo-2,#c3dafe);--theme-ui-colors-indigo-3:var(--theme-ui-colors-indigo-3,#a3bffa);--theme-ui-colors-indigo-4:var(--theme-ui-colors-indigo-4,#7f9cf5);--theme-ui-colors-indigo-5:var(--theme-ui-colors-indigo-5,#667eea);--theme-ui-colors-indigo-6:var(--theme-ui-colors-indigo-6,#5a67d8);--theme-ui-colors-indigo-7:var(--theme-ui-colors-indigo-7,#4c51bf);--theme-ui-colors-indigo-8:var(--theme-ui-colors-indigo-8,#434190);--theme-ui-colors-indigo-9:var(--theme-ui-colors-indigo-9,#3c366b);--theme-ui-colors-purple-0:var(--theme-ui-colors-purple-0,null);--theme-ui-colors-purple-1:var(--theme-ui-colors-purple-1,#faf5ff);--theme-ui-colors-purple-2:var(--theme-ui-colors-purple-2,#e9d8fd);--theme-ui-colors-purple-3:var(--theme-ui-colors-purple-3,#d6bcfa);--theme-ui-colors-purple-4:var(--theme-ui-colors-purple-4,#b794f4);--theme-ui-colors-purple-5:var(--theme-ui-colors-purple-5,#9f7aea);--theme-ui-colors-purple-6:var(--theme-ui-colors-purple-6,#805ad5);--theme-ui-colors-purple-7:var(--theme-ui-colors-purple-7,#6b46c1);--theme-ui-colors-purple-8:var(--theme-ui-colors-purple-8,#553c9a);--theme-ui-colors-purple-9:var(--theme-ui-colors-purple-9,#44337a);--theme-ui-colors-pink-0:var(--theme-ui-colors-pink-0,null);--theme-ui-colors-pink-1:var(--theme-ui-colors-pink-1,#fff5f7);--theme-ui-colors-pink-2:var(--theme-ui-colors-pink-2,#fed7e2);--theme-ui-colors-pink-3:var(--theme-ui-colors-pink-3,#fbb6ce);--theme-ui-colors-pink-4:var(--theme-ui-colors-pink-4,#f687b3);--theme-ui-colors-pink-5:var(--theme-ui-colors-pink-5,#ed64a6);--theme-ui-colors-pink-6:var(--theme-ui-colors-pink-6,#d53f8c);--theme-ui-colors-pink-7:var(--theme-ui-colors-pink-7,#b83280);--theme-ui-colors-pink-8:var(--theme-ui-colors-pink-8,#97266d);--theme-ui-colors-pink-9:var(--theme-ui-colors-pink-9,#702459);--theme-ui-colors-grayDark:var(--theme-ui-colors-grayDark,#2d3748);--theme-ui-colors-text:var(--theme-ui-colors-text,#2d3748);--theme-ui-colors-background:var(--theme-ui-colors-background,#fff);--theme-ui-colors-primary:var(--theme-ui-colors-primary,#2b6cb0);--theme-ui-colors-primaryHover:var(--theme-ui-colors-primaryHover,#2c5282);--theme-ui-colors-secondary:var(--theme-ui-colors-secondary,#718096);--theme-ui-colors-muted:var(--theme-ui-colors-muted,#e2e8f0);--theme-ui-colors-success:var(--theme-ui-colors-success,#9ae6b4);--theme-ui-colors-info:var(--theme-ui-colors-info,#63b3ed);--theme-ui-colors-warning:var(--theme-ui-colors-warning,#faf089);--theme-ui-colors-danger:var(--theme-ui-colors-danger,#feb2b2);--theme-ui-colors-light:var(--theme-ui-colors-light,#f7fafc);--theme-ui-colors-dark:var(--theme-ui-colors-dark,#2d3748);--theme-ui-colors-textMuted:var(--theme-ui-colors-textMuted,#718096);--theme-ui-colors-toggleIcon:var(--theme-ui-colors-toggleIcon,#2d3748);--theme-ui-colors-heading:var(--theme-ui-colors-heading,#000);--theme-ui-colors-divide:var(--theme-ui-colors-divide,#cbd5e0);color:var(--theme-ui-colors-text,#2d3748);background-color:var(--theme-ui-colors-background,#fff);}body.theme-ui-dark{--theme-ui-colors-text:var(--theme-ui-colors-modes-dark-text,#cbd5e0);--theme-ui-colors-primary:var(--theme-ui-colors-modes-dark-primary,#63b3ed);--theme-ui-colors-secondary:var(--theme-ui-colors-modes-dark-secondary,#7f8ea3);--theme-ui-colors-toggleIcon:var(--theme-ui-colors-modes-dark-toggleIcon,#cbd5e0);--theme-ui-colors-background:var(--theme-ui-colors-modes-dark-background,#1A202C);--theme-ui-colors-heading:var(--theme-ui-colors-modes-dark-heading,#fff);--theme-ui-colors-divide:var(--theme-ui-colors-modes-dark-divide,#2d3748);--theme-ui-colors-muted:var(--theme-ui-colors-modes-dark-muted,#2d3748);}&lt;/style&gt;&lt;style data-emotion-css=&quot;tm2q0o&quot;&gt;*{box-sizing:border-box;}body{margin:0;font-family:&quot;IBM Plex Sans&quot;,-apple-system,BlinkMacSystemFont,&quot;Segoe UI&quot;,Roboto,&quot;Helvetica Neue&quot;,Arial,&quot;Noto Sans&quot;,sans-serif,&quot;Apple Color Emoji&quot;,&quot;Segoe UI Emoji&quot;,&quot;Segoe UI Symbol&quot;,&quot;Noto Color Emoji&quot;;line-height:1.625;font-weight:400;color:var(--theme-ui-colors-text,#2d3748);background-color:var(--theme-ui-colors-background,#fff);padding:0;box-sizing:border-box;text-rendering:optimizeLegibility;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;}&lt;/style&gt;&lt;style data-emotion-css=&quot;ocxwk4&quot;&gt;.css-ocxwk4{font-size:1rem;-webkit-letter-spacing:-0.003em;-moz-letter-spacing:-0.003em;-ms-letter-spacing:-0.003em;letter-spacing:-0.003em;line-height:1.625;--baseline-multiplier:0.179;--x-height-multiplier:0.35;word-break:break-word;}@media screen and (min-width:640px){.css-ocxwk4{font-size:1rem;}}@media screen and (min-width:768px){.css-ocxwk4{font-size:1.1rem;}}&lt;/style&gt;&lt;p class=&quot;css-ocxwk4&quot;&gt;&lt;em class=&quot;css-0&quot;&gt;This is the third post in a series about building a simple wireless temperature and humidity sensor using inexpensive components, Bluetooth Low Energy (BLE) for communication, and Apple HomeKit to read sensor values. For the previous post, see &lt;style data-emotion-css=&quot;1i9b1eb&quot;&gt;.css-1i9b1eb{color:var(--theme-ui-colors-primary,#2b6cb0);-webkit-text-decoration:none;text-decoration:none;}.css-1i9b1eb:hover{-webkit-text-decoration:underline;text-decoration:underline;}&lt;/style&gt;&lt;a href=&quot;/blog/ble-homekit-sensor-pt2&quot; class=&quot;css-1i9b1eb&quot;&gt;Part 2&lt;/a&gt;&lt;/em&gt;.&lt;/p&gt;&lt;p class=&quot;css-ocxwk4&quot;&gt;In the previous post, we covered the &lt;strong class=&quot;css-0&quot;&gt;hardware selection&lt;/strong&gt;, &lt;strong class=&quot;css-0&quot;&gt;hardware assembly&lt;/strong&gt;, and &lt;strong class=&quot;css-0&quot;&gt;software architecture&lt;/strong&gt;. In this post, we&amp;#x27;ll cover the last, crucial piece needed to make everything work: the software implementation.&lt;/p&gt;&lt;p class=&quot;css-ocxwk4&quot;&gt;This post includes the source code and all the information you need in order to get your own sensor and bridge hardware running.&lt;/p&gt;&lt;style data-emotion-css=&quot;992wu8&quot;&gt;.css-992wu8{font-family:inherit;font-weight:500;line-height:1.25;margin:0;margin-bottom:0.25rem;font-size:1.6rem;margin-top:2rem;color:var(--theme-ui-colors-heading,#000);}@media screen and (min-width:640px){.css-992wu8{font-size:1.8rem;}}@media screen and (min-width:768px){.css-992wu8{font-size:1.8rem;}}@media screen and (min-width:1024px){.css-992wu8{font-size:2rem;}}&lt;/style&gt;&lt;h2 class=&quot;css-992wu8&quot;&gt;Source code repository&lt;/h2&gt;&lt;p class=&quot;css-ocxwk4&quot;&gt;The source code for this project can be found on GitHub at &lt;a href=&quot;https://github.com/danielpgross/homekit-ble-temp-humid-sensor&quot; class=&quot;css-1i9b1eb&quot;&gt;danielpgross/homekit-ble-temp-humid-sensor&lt;/a&gt;.&lt;/p&gt;&lt;p class=&quot;css-ocxwk4&quot;&gt;If you&amp;#x27;d like to follow along with the instructions using your own bridge and sensor hardware, you&amp;#x27;ll want to start by cloning that repository to a local place.&lt;/p&gt;&lt;h2 class=&quot;css-992wu8&quot;&gt;Sensor module&lt;/h2&gt;&lt;p class=&quot;css-ocxwk4&quot;&gt;The sensor module runs on the WRL-13990 Bluetooth module, which is built around the nRF52832. Its purpose is to take readings from the temperature/humidity sensor and relay those readings back to the HomeKit bridge (see the bridge module below).&lt;/p&gt;&lt;style data-emotion-css=&quot;3omw84&quot;&gt;.css-3omw84{font-family:inherit;font-weight:500;line-height:1.25;margin:0;margin-bottom:0.25rem;font-size:1.3rem;margin-top:2rem;color:var(--theme-ui-colors-heading,#000);}@media screen and (min-width:640px){.css-3omw84{font-size:1.6rem;}}@media screen and (min-width:768px){.css-3omw84{font-size:1.6rem;}}@media screen and (min-width:1024px){.css-3omw84{font-size:1.8rem;}}&lt;/style&gt;&lt;h3 class=&quot;css-3omw84&quot;&gt;Implementation discussion&lt;/h3&gt;&lt;p class=&quot;css-ocxwk4&quot;&gt;The nRF52832 is a system-on-a-chip (SoC) built around the ARM Cortex M4 processor. Nordic provides a software development kit (SDK) that allows developers to write C code to program the device. Additionally, the chip is programmed by default with a &amp;quot;softdevice&amp;quot; that manages the fine details of BLE communication, allowing the developer to focus on the business logic of the application at hand.&lt;/p&gt;&lt;p class=&quot;css-ocxwk4&quot;&gt;This diagram from the &lt;a href=&quot;http://infocenter.nordicsemi.com/pdf/S132_SDS_v5.0.pdf&quot; class=&quot;css-1i9b1eb&quot;&gt;S132 SoftDevice specification&lt;/a&gt; illustrates the general architecture of software implementations on the nRF52832:
&lt;span class=&quot;gatsby-resp-image-wrapper&quot; style=&quot;position:relative;display:block;margin-left:auto;margin-right:auto;max-width:462px&quot;&gt;
      &lt;span class=&quot;gatsby-resp-image-background-image&quot; style=&quot;padding-bottom:102.91666666666669%;position:relative;bottom:0;left:0;background-image:url(&amp;#x27;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAVCAYAAABG1c6oAAAACXBIWXMAAAsSAAALEgHS3X78AAADzklEQVQ4y5WUyW/bVhDG9fcWaM9FL0Xc9tZLUMRFsxSNgyKJ7dqWZC2UTNqkxFUbSUkktXDRRi12DDt2cv06fLKV2j3l8MM38zhvMPNmwJTnmbAtBW1bI9QN3Y4B16nB6Rpk6xubQXaHzv4bz2hrSFmWTE6FklY22mnLkMRjFPK7EPg0qpU8Crn3zD4pH4Lj9qEqHIu7v3d/N8WqsyTm2KRmS2Qfa8YJFLkAQy+jURcoQRG6VmJoKsfOkjuWKcI2JXbXIk35vkdOUn6N2mohCnvokiZ4nk1YjMGgw9R1LXaeqOOY7MxxTbLX8amk77ZdpaRV9i7nqwWctoFWvYp40sfl+QgdS0OjRjEtDcs4wPXlDOGww2IahoTzRYgPqxHOlxG9oXn/hhKcjopoOsexMcSxPkCONGcMkCX7QGpj/7SFA9FCWu4iq/aQ1frIkK7jhijWh+uEyVuY1H/PUaE5Y/yYDrGVHuLJ0RBb2Qg/H0f4/k0N322f4JuneXy7XcYPb006D/FTxscW8STt4xfyU8m4nW6yJgqGPQNKJ8Su1IdoBhCaAf7gPBwaUxStJQrWao25RL612JBrzcFZC7zgfaR0TYB4lmUr0TR46E6EvZMGRM2EIDfxsmBBdC+h+x+hDK+hPuAjQxlcox7dYkekChW5jFcvn+L3Z79CqdKauCPs8y1UjTbOVJMlFLofoEefoQWfoAa3DC38Yiv+Leqjz/jrLGm5rbK9ksTcXcsR3vAOSrqHnOLieamHkhkjI/dwVPVoIDQE3Uea7Kw6YBySzdVDvE4qTIaSbHyyOj1HYwn/FrrgDRec6uJFycWJvaAJRjTJkHQErjFG3giYJn6+FkGwZncJLflu4yWWUOtShTkF7w5yOMqf4lVx3TJrkVpLUPybu1Zv1v7wBjV6kk2F9wn7SYXtAAdnFop8Bdypih1q/8y5gBHeQKPBJOiPSAbTHH1aD6XT1tnaWJS072qoeRP8yfdosX0cKQP8VvDwVpngHyPGnj7DPpHorjrZ8J7Y06bYLtPaBEEftl1HEAwxnkywvLiipFNqfUQrNEazH6PSor1seEylZo+pTt8N5wuJbw5m9LexG5CkMvoDH+P4A8LJErP5+QN0owlZNWDUW1D1OhpNG5N4iXhxsY5ZJFxgOl8hFcchrq5izOch4jjCnIgfsVpNidlGl8vp/2LuScXzKbUaYjobYUI6HgdE+IDRKCD8OyVYzOO4gOVJFQUZz3f28PpdBrsZHpmyjDRXRbr0ldCdLN1NiUqNEpVwkOPpoIKCoCIvKF8Pr6BIa/Yv7zeVbIV2hyQAAAAASUVORK5CYII=&amp;#x27;);background-size:cover;display:block&quot;&gt;&lt;/span&gt;
  &lt;img class=&quot;gatsby-resp-image-image css-0&quot; alt=&quot;nrf5 ble arch&quot; title=&quot;nrf5 ble arch&quot; src=&quot;/static/1cdb0859240c6f025bfa4d9adfda7599/36de5/nrf5-ble-arch.png&quot; srcSet=&quot;/static/1cdb0859240c6f025bfa4d9adfda7599/5243c/nrf5-ble-arch.png 240w,/static/1cdb0859240c6f025bfa4d9adfda7599/36de5/nrf5-ble-arch.png 462w&quot; sizes=&quot;(max-width: 462px) 100vw, 462px&quot; style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0&quot; loading=&quot;lazy&quot;/&gt;
    &lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;css-ocxwk4&quot;&gt;For more information on the nRF52832&amp;#x27;s software, check out the following resources:&lt;/p&gt;&lt;style data-emotion-css=&quot;aq9zkf&quot;&gt;.css-aq9zkf li{font-size:1rem;-webkit-letter-spacing:-0.003em;-moz-letter-spacing:-0.003em;-ms-letter-spacing:-0.003em;letter-spacing:-0.003em;line-height:1.625;--baseline-multiplier:0.179;--x-height-multiplier:0.35;}@media screen and (min-width:640px){.css-aq9zkf li{font-size:1rem;}}@media screen and (min-width:768px){.css-aq9zkf li{font-size:1.1rem;}}&lt;/style&gt;&lt;ul class=&quot;css-aq9zkf&quot;&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;a href=&quot;http://infocenter.nordicsemi.com/index.jsp?topic=%2Fcom.nordic.infocenter.sdk%2Fdita%2Fsdk%2Fnrf5_sdk.html&quot; class=&quot;css-1i9b1eb&quot;&gt;nRF5 SDK Documentation&lt;/a&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;a href=&quot;http://infocenter.nordicsemi.com/index.jsp?topic=%2Fcom.nordic.infocenter.softdevices52%2Fdita%2Fnrf52%2Fsoftdevices.html&amp;amp;cp=2_3&quot; class=&quot;css-1i9b1eb&quot;&gt;nRF5 SoftDevice Documentation&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p class=&quot;css-ocxwk4&quot;&gt;The nRF52832 can be very tricky to program because there&amp;#x27;s very little transparency into what&amp;#x27;s going on inside the device. Although it&amp;#x27;s possible to set up a line-by-line debugger, this requires extra hardware, as far as I was able to find. Therefore, programming the devices requires lots of patience :-)...&lt;/p&gt;&lt;style data-emotion-css=&quot;1pmnorg&quot;&gt;.css-1pmnorg{font-family:inherit;font-weight:500;line-height:1.25;margin:0;margin-bottom:0.25rem;font-size:1.1rem;color:var(--theme-ui-colors-heading,#000);margin-top:1rem;}@media screen and (min-width:640px){.css-1pmnorg{font-size:1.3rem;}}@media screen and (min-width:768px){.css-1pmnorg{font-size:1.3rem;}}@media screen and (min-width:1024px){.css-1pmnorg{font-size:1.6rem;}}&lt;/style&gt;&lt;h4 class=&quot;css-1pmnorg&quot;&gt;Making the SDK code build and run on the WRL-13990&lt;/h4&gt;&lt;p class=&quot;css-ocxwk4&quot;&gt;Nordic&amp;#x27;s SDK code is written to support different boards built on the nRF52832, but not including the WRL-13990. This meant that some wrangling was necessary to get the code to build and run properly on the WRL-13990. Luckily, I was able to get this working by cobbling together other pieces of code that I knew worked on the WRL-13990, including &lt;a href=&quot;https://github.com/sandeepmistry/arduino-nRF5&quot; class=&quot;css-1i9b1eb&quot;&gt;the nRF5 Arduino core code&lt;/a&gt;.&lt;/p&gt;&lt;h4 class=&quot;css-1pmnorg&quot;&gt;Temperature readings&lt;/h4&gt;&lt;p class=&quot;css-ocxwk4&quot;&gt;The nRF5 SDK does not natively support reading data from the DHT-22 sensor. This turned out to be more complicated than I thought, but I fortunately stumbled across Gabor Paller&amp;#x27;s &lt;a href=&quot;http://mylifewithandroid.blogspot.ca/2016/02/thermometer-application-with-nrf51822.html&quot; class=&quot;css-1i9b1eb&quot;&gt;blog post on using the DHT-22 with an nRF51822&lt;/a&gt;. He wrote a complete implementation for reading DHT-22 sensor values and I was able to use this directly in my own implementation. &lt;/p&gt;&lt;h4 class=&quot;css-1pmnorg&quot;&gt;BLE broadcast format&lt;/h4&gt;&lt;p class=&quot;css-ocxwk4&quot;&gt;The sensor module broadcasts readings with the BLE service ID &lt;code class=&quot;css-0&quot;&gt;7B18&lt;/code&gt; and with the actual temperature and humidity readings in the BLE GAP service data. Using this approach, a listening device &lt;em class=&quot;css-0&quot;&gt;does not need to pair with the sensor&lt;/em&gt;, it just needs to look for the appropriate service ID and then read the value of the service data. To see exactly how the temperature and humidity are encoded, see the &lt;a href=&quot;https://github.com/danielpgross/homekit-ble-temp-humid-sensor/blob/d9d85c7afd3e7e6ddb8a10b890ce69e1c8a00d7c/bridge/TempHumidSensor_accessory.js#L42-L43&quot; class=&quot;css-1i9b1eb&quot;&gt;decoding implementation&lt;/a&gt;.&lt;/p&gt;&lt;h3 class=&quot;css-3omw84&quot;&gt;Using it yourself&lt;/h3&gt;&lt;p class=&quot;css-ocxwk4&quot;&gt;&lt;em class=&quot;css-0&quot;&gt;The following is copied from the &lt;a href=&quot;https://github.com/danielpgross/homekit-ble-temp-humid-sensor/blob/master/sensor/README.md&quot; class=&quot;css-1i9b1eb&quot;&gt;README file in the source code repository&lt;/a&gt;. Please see that file to keep up to date with any changes.&lt;/em&gt;&lt;/p&gt;&lt;p class=&quot;css-ocxwk4&quot;&gt;This is firmware code for the nRF52832. To use it, you need to compile it to binary code and then flash it to your device.&lt;/p&gt;&lt;h4 class=&quot;css-1pmnorg&quot;&gt;Requirements&lt;/h4&gt;&lt;ul class=&quot;css-aq9zkf&quot;&gt;&lt;li class=&quot;css-0&quot;&gt;The nRF5 SDK, which provides the necessary compilation resources and tools. Instructions to download it are in step 1 below.&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;Installation of &lt;strong class=&quot;css-0&quot;&gt;version 0.5.2&lt;/strong&gt; of &lt;a href=&quot;https://github.com/NordicSemiconductor/pc-nrfutil&quot; class=&quot;css-1i9b1eb&quot;&gt;Nordic&amp;#x27;s nrfutil program&lt;/a&gt;. Installation instructions are provided at the source.&lt;/li&gt;&lt;/ul&gt;&lt;h4 class=&quot;css-1pmnorg&quot;&gt;Compilation &amp;amp; flashing&lt;/h4&gt;&lt;ol class=&quot;css-aq9zkf&quot;&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-ocxwk4&quot;&gt;Download the &lt;a href=&quot;https://developer.nordicsemi.com/nRF5_SDK/nRF5_SDK_v11.x.x/nRF5_SDK_11.0.0_89a8197.zip&quot; class=&quot;css-1i9b1eb&quot;&gt;nRF5 SDK version 11.0.0&lt;/a&gt;.&lt;/p&gt;&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;&quot;&gt;&lt;pre class=&quot;prism-code language-&quot; style=&quot;color:#d6deeb;background-color:#011627&quot; data-linenumber=&quot;true&quot;&gt;&lt;style data-emotion-css=&quot;1heep1n&quot;&gt;.css-1heep1n{background-color:rgba(43,108,176,0.2);border:none;color:var(--theme-ui-colors-gray-2,#edf2f7);cursor:pointer;font-size:14px;font-family:&quot;IBM Plex Sans&quot;,-apple-system,BlinkMacSystemFont,&quot;Segoe UI&quot;,Roboto,&quot;Helvetica Neue&quot;,Arial,&quot;Noto Sans&quot;,sans-serif,&quot;Apple Color Emoji&quot;,&quot;Segoe UI Emoji&quot;,&quot;Segoe UI Symbol&quot;,&quot;Noto Color Emoji&quot;;-webkit-letter-spacing:0.025rem;-moz-letter-spacing:0.025rem;-ms-letter-spacing:0.025rem;letter-spacing:0.025rem;-webkit-transition:default;transition:default;position:absolute;top:0;right:0;z-index:1;border-radius:0 0 0 0.25rem;padding:0.25rem 0.6rem;}@media screen and (min-width:640px){.css-1heep1n{font-size:14px;}}@media screen and (min-width:768px){.css-1heep1n{font-size:16px;}}.css-1heep1n[disabled]{cursor:not-allowed;}.css-1heep1n:not([disabled]):hover{background-color:var(--theme-ui-colors-primary,#2b6cb0);color:var(--theme-ui-colors-white,#fff);}&lt;/style&gt;&lt;button type=&quot;button&quot; name=&quot;copy code to clipboard&quot; class=&quot;code-copy-button css-1heep1n&quot;&gt;Copy&lt;style data-emotion-css=&quot;1gy8470&quot;&gt;.css-1gy8470{border:0;-webkit-clip:rect(0,0,0,0);clip:rect(0,0,0,0);height:1px;margin:-1px;overflow:hidden;padding:0;position:absolute;white-space:nowrap;width:1px;}&lt;/style&gt;&lt;span aria-roledescription=&quot;status&quot; class=&quot;css-1gy8470&quot;&gt;copy code to clipboard&lt;/span&gt;&lt;/button&gt;&lt;code class=&quot;language-&quot;&gt;&lt;div class=&quot;token-line&quot; style=&quot;color:#d6deeb&quot;&gt;&lt;span class=&quot;line-number-style&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token plain&quot;&gt;wget https://developer.nordicsemi.com/nRF5_SDK/nRF5_SDK_v11.x.x/nRF5_SDK_11.0.0_89a8197.zip&lt;/span&gt;&lt;/div&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-ocxwk4&quot;&gt;Unzip the SDK.&lt;/p&gt;&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;&quot;&gt;&lt;pre class=&quot;prism-code language-&quot; style=&quot;color:#d6deeb;background-color:#011627&quot; data-linenumber=&quot;true&quot;&gt;&lt;button type=&quot;button&quot; name=&quot;copy code to clipboard&quot; class=&quot;code-copy-button css-1heep1n&quot;&gt;Copy&lt;span aria-roledescription=&quot;status&quot; class=&quot;css-1gy8470&quot;&gt;copy code to clipboard&lt;/span&gt;&lt;/button&gt;&lt;code class=&quot;language-&quot;&gt;&lt;div class=&quot;token-line&quot; style=&quot;color:#d6deeb&quot;&gt;&lt;span class=&quot;line-number-style&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token plain&quot;&gt;unzip nRF5_SDK_11.0.0_89a8197.zip&lt;/span&gt;&lt;/div&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-ocxwk4&quot;&gt;Navigate to this path within the unzipped SDK folder: &lt;code class=&quot;css-0&quot;&gt;examples/ble_peripheral/&lt;/code&gt;.&lt;/p&gt;&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;&quot;&gt;&lt;pre class=&quot;prism-code language-&quot; style=&quot;color:#d6deeb;background-color:#011627&quot; data-linenumber=&quot;true&quot;&gt;&lt;button type=&quot;button&quot; name=&quot;copy code to clipboard&quot; class=&quot;code-copy-button css-1heep1n&quot;&gt;Copy&lt;span aria-roledescription=&quot;status&quot; class=&quot;css-1gy8470&quot;&gt;copy code to clipboard&lt;/span&gt;&lt;/button&gt;&lt;code class=&quot;language-&quot;&gt;&lt;div class=&quot;token-line&quot; style=&quot;color:#d6deeb&quot;&gt;&lt;span class=&quot;line-number-style&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token plain&quot;&gt;cd nRF5_SDK_11.0.0_89a8197/examples/ble_peripheral/&lt;/span&gt;&lt;/div&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-ocxwk4&quot;&gt;There, copy the entire folder containing this file, with the directory name &lt;code class=&quot;css-0&quot;&gt;ble_app_temp_humid&lt;/code&gt;.&lt;/p&gt;&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;&quot;&gt;&lt;pre class=&quot;prism-code language-&quot; style=&quot;color:#d6deeb;background-color:#011627&quot; data-linenumber=&quot;true&quot;&gt;&lt;button type=&quot;button&quot; name=&quot;copy code to clipboard&quot; class=&quot;code-copy-button css-1heep1n&quot;&gt;Copy&lt;span aria-roledescription=&quot;status&quot; class=&quot;css-1gy8470&quot;&gt;copy code to clipboard&lt;/span&gt;&lt;/button&gt;&lt;code class=&quot;language-&quot;&gt;&lt;div class=&quot;token-line&quot; style=&quot;color:#d6deeb&quot;&gt;&lt;span class=&quot;line-number-style&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token plain&quot;&gt;cp -R /path/to/repo/sensor ./ble_app_temp_humid&lt;/span&gt;&lt;/div&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-ocxwk4&quot;&gt;Build the code.&lt;/p&gt;&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;&quot;&gt;&lt;pre class=&quot;prism-code language-&quot; style=&quot;color:#d6deeb;background-color:#011627&quot; data-linenumber=&quot;true&quot;&gt;&lt;button type=&quot;button&quot; name=&quot;copy code to clipboard&quot; class=&quot;code-copy-button css-1heep1n&quot;&gt;Copy&lt;span aria-roledescription=&quot;status&quot; class=&quot;css-1gy8470&quot;&gt;copy code to clipboard&lt;/span&gt;&lt;/button&gt;&lt;code class=&quot;language-&quot;&gt;&lt;div class=&quot;token-line&quot; style=&quot;color:#d6deeb&quot;&gt;&lt;span class=&quot;line-number-style&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token plain&quot;&gt;cd ble_app_temp_humid/wrl13990/s132/armgcc&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;token-line&quot; style=&quot;color:#d6deeb&quot;&gt;&lt;span class=&quot;line-number-style&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;token plain&quot;&gt;make&lt;/span&gt;&lt;/div&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p class=&quot;css-ocxwk4&quot;&gt;You should see build output as follows:&lt;/p&gt;&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;&quot;&gt;&lt;pre class=&quot;prism-code language-&quot; style=&quot;color:#d6deeb;background-color:#011627&quot; data-linenumber=&quot;true&quot;&gt;&lt;button type=&quot;button&quot; name=&quot;copy code to clipboard&quot; class=&quot;code-copy-button css-1heep1n&quot;&gt;Copy&lt;span aria-roledescription=&quot;status&quot; class=&quot;css-1gy8470&quot;&gt;copy code to clipboard&lt;/span&gt;&lt;/button&gt;&lt;code class=&quot;language-&quot;&gt;&lt;div class=&quot;token-line&quot; style=&quot;color:#d6deeb&quot;&gt;&lt;span class=&quot;line-number-style&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token plain&quot;&gt;rm -rf _build&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;token-line&quot; style=&quot;color:#d6deeb&quot;&gt;&lt;span class=&quot;line-number-style&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;token plain&quot;&gt;echo  Makefile&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;token-line&quot; style=&quot;color:#d6deeb&quot;&gt;&lt;span class=&quot;line-number-style&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;token plain&quot;&gt;Makefile&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;token-line&quot; style=&quot;color:#d6deeb&quot;&gt;&lt;span class=&quot;line-number-style&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;token plain&quot;&gt;mkdir _build&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;token-line&quot; style=&quot;color:#d6deeb&quot;&gt;&lt;span class=&quot;line-number-style&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;token plain&quot;&gt;Compiling file: app_button.c&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;token-line&quot; style=&quot;color:#d6deeb&quot;&gt;&lt;span class=&quot;line-number-style&quot;&gt;6&lt;/span&gt;&lt;span class=&quot;token plain&quot;&gt;Compiling file: app_error.c&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;token-line&quot; style=&quot;color:#d6deeb&quot;&gt;&lt;span class=&quot;line-number-style&quot;&gt;7&lt;/span&gt;&lt;span class=&quot;token plain&quot;&gt;Compiling file: app_error_weak.c&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;token-line&quot; style=&quot;color:#d6deeb&quot;&gt;&lt;span class=&quot;line-number-style&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;token plain&quot;&gt;Compiling file: app_fifo.c&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;token-line&quot; style=&quot;color:#d6deeb&quot;&gt;&lt;span class=&quot;line-number-style&quot;&gt;9&lt;/span&gt;&lt;span class=&quot;token plain&quot;&gt;Compiling file: app_timer.c&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;token-line&quot; style=&quot;color:#d6deeb&quot;&gt;&lt;span class=&quot;line-number-style&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;token plain&quot;&gt;Compiling file: app_trace.c&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;token-line&quot; style=&quot;color:#d6deeb&quot;&gt;&lt;span class=&quot;line-number-style&quot;&gt;11&lt;/span&gt;&lt;span class=&quot;token plain&quot;&gt;Compiling file: app_util_platform.c&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;token-line&quot; style=&quot;color:#d6deeb&quot;&gt;&lt;span class=&quot;line-number-style&quot;&gt;12&lt;/span&gt;&lt;span class=&quot;token plain&quot;&gt;Compiling file: fstorage.c&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;token-line&quot; style=&quot;color:#d6deeb&quot;&gt;&lt;span class=&quot;line-number-style&quot;&gt;13&lt;/span&gt;&lt;span class=&quot;token plain&quot;&gt;Compiling file: nrf_assert.c&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;token-line&quot; style=&quot;color:#d6deeb&quot;&gt;&lt;span class=&quot;line-number-style&quot;&gt;14&lt;/span&gt;&lt;span class=&quot;token plain&quot;&gt;Compiling file: nrf_log.c&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;token-line&quot; style=&quot;color:#d6deeb&quot;&gt;&lt;span class=&quot;line-number-style&quot;&gt;15&lt;/span&gt;&lt;span class=&quot;token plain&quot;&gt;Compiling file: retarget.c&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;token-line&quot; style=&quot;color:#d6deeb&quot;&gt;&lt;span class=&quot;line-number-style&quot;&gt;16&lt;/span&gt;&lt;span class=&quot;token plain&quot;&gt;Compiling file: nrf_delay.c&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;token-line&quot; style=&quot;color:#d6deeb&quot;&gt;&lt;span class=&quot;line-number-style&quot;&gt;17&lt;/span&gt;&lt;span class=&quot;token plain&quot;&gt;Compiling file: nrf_drv_common.c&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;token-line&quot; style=&quot;color:#d6deeb&quot;&gt;&lt;span class=&quot;line-number-style&quot;&gt;18&lt;/span&gt;&lt;span class=&quot;token plain&quot;&gt;Compiling file: nrf_drv_gpiote.c&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;token-line&quot; style=&quot;color:#d6deeb&quot;&gt;&lt;span class=&quot;line-number-style&quot;&gt;19&lt;/span&gt;&lt;span class=&quot;token plain&quot;&gt;Compiling file: pstorage.c&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;token-line&quot; style=&quot;color:#d6deeb&quot;&gt;&lt;span class=&quot;line-number-style&quot;&gt;20&lt;/span&gt;&lt;span class=&quot;token plain&quot;&gt;Compiling file: bsp.c&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;token-line&quot; style=&quot;color:#d6deeb&quot;&gt;&lt;span class=&quot;line-number-style&quot;&gt;21&lt;/span&gt;&lt;span class=&quot;token plain&quot;&gt;Compiling file: bsp_btn_ble.c&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;token-line&quot; style=&quot;color:#d6deeb&quot;&gt;&lt;span class=&quot;line-number-style&quot;&gt;22&lt;/span&gt;&lt;span class=&quot;token plain&quot;&gt;Compiling file: main.c&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;token-line&quot; style=&quot;color:#d6deeb&quot;&gt;&lt;span class=&quot;line-number-style&quot;&gt;23&lt;/span&gt;&lt;span class=&quot;token plain&quot;&gt;Compiling file: dht22.c&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;token-line&quot; style=&quot;color:#d6deeb&quot;&gt;&lt;span class=&quot;line-number-style&quot;&gt;24&lt;/span&gt;&lt;span class=&quot;token plain&quot;&gt;Compiling file: RTT_Syscalls_GCC.c&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;token-line&quot; style=&quot;color:#d6deeb&quot;&gt;&lt;span class=&quot;line-number-style&quot;&gt;25&lt;/span&gt;&lt;span class=&quot;token plain&quot;&gt;Compiling file: SEGGER_RTT.c&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;token-line&quot; style=&quot;color:#d6deeb&quot;&gt;&lt;span class=&quot;line-number-style&quot;&gt;26&lt;/span&gt;&lt;span class=&quot;token plain&quot;&gt;Compiling file: SEGGER_RTT_printf.c&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;token-line&quot; style=&quot;color:#d6deeb&quot;&gt;&lt;span class=&quot;line-number-style&quot;&gt;27&lt;/span&gt;&lt;span class=&quot;token plain&quot;&gt;Compiling file: ble_advdata.c&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;token-line&quot; style=&quot;color:#d6deeb&quot;&gt;&lt;span class=&quot;line-number-style&quot;&gt;28&lt;/span&gt;&lt;span class=&quot;token plain&quot;&gt;Compiling file: ble_advertising.c&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;token-line&quot; style=&quot;color:#d6deeb&quot;&gt;&lt;span class=&quot;line-number-style&quot;&gt;29&lt;/span&gt;&lt;span class=&quot;token plain&quot;&gt;Compiling file: ble_bas.c&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;token-line&quot; style=&quot;color:#d6deeb&quot;&gt;&lt;span class=&quot;line-number-style&quot;&gt;30&lt;/span&gt;&lt;span class=&quot;token plain&quot;&gt;Compiling file: ble_bps.c&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;token-line&quot; style=&quot;color:#d6deeb&quot;&gt;&lt;span class=&quot;line-number-style&quot;&gt;31&lt;/span&gt;&lt;span class=&quot;token plain&quot;&gt;Compiling file: ble_conn_params.c&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;token-line&quot; style=&quot;color:#d6deeb&quot;&gt;&lt;span class=&quot;line-number-style&quot;&gt;32&lt;/span&gt;&lt;span class=&quot;token plain&quot;&gt;Compiling file: ble_dis.c&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;token-line&quot; style=&quot;color:#d6deeb&quot;&gt;&lt;span class=&quot;line-number-style&quot;&gt;33&lt;/span&gt;&lt;span class=&quot;token plain&quot;&gt;Compiling file: ble_srv_common.c&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;token-line&quot; style=&quot;color:#d6deeb&quot;&gt;&lt;span class=&quot;line-number-style&quot;&gt;34&lt;/span&gt;&lt;span class=&quot;token plain&quot;&gt;Compiling file: device_manager_peripheral.c&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;token-line&quot; style=&quot;color:#d6deeb&quot;&gt;&lt;span class=&quot;line-number-style&quot;&gt;35&lt;/span&gt;&lt;span class=&quot;token plain&quot;&gt;Compiling file: system_nrf52.c&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;token-line&quot; style=&quot;color:#d6deeb&quot;&gt;&lt;span class=&quot;line-number-style&quot;&gt;36&lt;/span&gt;&lt;span class=&quot;token plain&quot;&gt;Compiling file: softdevice_handler.c&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;token-line&quot; style=&quot;color:#d6deeb&quot;&gt;&lt;span class=&quot;line-number-style&quot;&gt;37&lt;/span&gt;&lt;span class=&quot;token plain&quot;&gt;Assembly file: gcc_startup_nrf52.s&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;token-line&quot; style=&quot;color:#d6deeb&quot;&gt;&lt;span class=&quot;line-number-style&quot;&gt;38&lt;/span&gt;&lt;span class=&quot;token plain&quot;&gt;Linking target: nrf52832_xxaa_s132.out&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;token-line&quot; style=&quot;color:#d6deeb&quot;&gt;&lt;span class=&quot;line-number-style&quot;&gt;39&lt;/span&gt;&lt;span class=&quot;token plain&quot;&gt;Preparing: nrf52832_xxaa_s132.bin&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;token-line&quot; style=&quot;color:#d6deeb&quot;&gt;&lt;span class=&quot;line-number-style&quot;&gt;40&lt;/span&gt;&lt;span class=&quot;token plain&quot;&gt;Preparing: nrf52832_xxaa_s132.hex&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;token-line&quot; style=&quot;color:#d6deeb&quot;&gt;&lt;span class=&quot;line-number-style&quot;&gt;41&lt;/span&gt;&lt;span class=&quot;token plain&quot; style=&quot;display:inline-block&quot;&gt;&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;token-line&quot; style=&quot;color:#d6deeb&quot;&gt;&lt;span class=&quot;line-number-style&quot;&gt;42&lt;/span&gt;&lt;span class=&quot;token plain&quot;&gt; text      data     bss     dec     hex filename&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;token-line&quot; style=&quot;color:#d6deeb&quot;&gt;&lt;span class=&quot;line-number-style&quot;&gt;43&lt;/span&gt;&lt;span class=&quot;token plain&quot;&gt;  9332      124     768   10224    27f0 _build/nrf52832_xxaa_s132.out&lt;/span&gt;&lt;/div&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-ocxwk4&quot;&gt;Connect the WRL13990 to your computer and begin flashing the compiled firmware. I used the following command to accomplish that using a FT232RL-based USB-to-serial board.&lt;/p&gt;&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;&quot;&gt;&lt;pre class=&quot;prism-code language-&quot; style=&quot;color:#d6deeb;background-color:#011627&quot; data-linenumber=&quot;true&quot;&gt;&lt;button type=&quot;button&quot; name=&quot;copy code to clipboard&quot; class=&quot;code-copy-button css-1heep1n&quot;&gt;Copy&lt;span aria-roledescription=&quot;status&quot; class=&quot;css-1gy8470&quot;&gt;copy code to clipboard&lt;/span&gt;&lt;/button&gt;&lt;code class=&quot;language-&quot;&gt;&lt;div class=&quot;token-line&quot; style=&quot;color:#d6deeb&quot;&gt;&lt;span class=&quot;line-number-style&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token plain&quot;&gt;nrfutil dfu genpkg --application _build/*.hex pkg.zip &amp;amp;&amp;amp; nrfutil dfu serial --package=pkg.zip --port=/dev/cu.usbserial-00000000 --baudrate=38400&lt;/span&gt;&lt;/div&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p class=&quot;css-ocxwk4&quot;&gt;With the following output.&lt;/p&gt;&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;&quot;&gt;&lt;pre class=&quot;prism-code language-&quot; style=&quot;color:#d6deeb;background-color:#011627&quot; data-linenumber=&quot;true&quot;&gt;&lt;button type=&quot;button&quot; name=&quot;copy code to clipboard&quot; class=&quot;code-copy-button css-1heep1n&quot;&gt;Copy&lt;span aria-roledescription=&quot;status&quot; class=&quot;css-1gy8470&quot;&gt;copy code to clipboard&lt;/span&gt;&lt;/button&gt;&lt;code class=&quot;language-&quot;&gt;&lt;div class=&quot;token-line&quot; style=&quot;color:#d6deeb&quot;&gt;&lt;span class=&quot;line-number-style&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token plain&quot;&gt;Zip created at pkg.zip&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;token-line&quot; style=&quot;color:#d6deeb&quot;&gt;&lt;span class=&quot;line-number-style&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;token plain&quot;&gt;Upgrading target on /dev/cu.usbserial-00000000 with DFU package /Users/danielgross/Desktop/ard-temp-sensor/nrf52/nRF5_SDK_11.0.0_89a8197/examples/ble_peripheral/ble_app_temp_humid/wrl13990/s132/armgcc/pkg.zip. Flow control is disabled.&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;token-line&quot; style=&quot;color:#d6deeb&quot;&gt;&lt;span class=&quot;line-number-style&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;token plain&quot;&gt;  [####################################]  100%          &lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;token-line&quot; style=&quot;color:#d6deeb&quot;&gt;&lt;span class=&quot;line-number-style&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;token plain&quot;&gt;Device programmed.&lt;/span&gt;&lt;/div&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/li&gt;&lt;/ol&gt;&lt;h2 class=&quot;css-992wu8&quot;&gt;Bridge module&lt;/h2&gt;&lt;p class=&quot;css-ocxwk4&quot;&gt;The bridge module can run on any device capable of Bluetooth and wifi communication, as well as running node.js. The bridge&amp;#x27;s purpose is to receive the temperature readings broadcast by the sensor module and retransmit those over the HomeKit protocol.&lt;/p&gt;&lt;h3 class=&quot;css-3omw84&quot;&gt;Implementation discussion&lt;/h3&gt;&lt;h4 class=&quot;css-1pmnorg&quot;&gt;HomeKit specification&lt;/h4&gt;&lt;p class=&quot;css-ocxwk4&quot;&gt;Until earlier this year, the details of the HomeKit specification have been kept private by Apple and only made available to members of the MFi program. Since the MFi program requires submitting an application and paying a membership fee, this information was not available to hobbyists looking to play with HomeKit devices. Fortunately, however, earlier this year Apple made the HomeKit specification available for personal, non-commercial use. The &lt;a href=&quot;https://developer.apple.com/homekit/specification/&quot; class=&quot;css-1i9b1eb&quot;&gt;HomeKit specification&lt;/a&gt; can now be accessed for free after creating an Apple Developer account and agreeing to use the documentation only for non-commercial purposes.&lt;/p&gt;&lt;h4 class=&quot;css-1pmnorg&quot;&gt;HomeKit framework&lt;/h4&gt;&lt;p class=&quot;css-ocxwk4&quot;&gt;As discussed in the first post of this series, I decided to use HAP-NodeJS, a node.js-based implementation of the HomeKit protocol. Since it already implements the details of the HomeKit protocol, implementing our sensor bridge becomes as simple as listening for the BLE broadcasts from the sensor and then calling the appropriate HAP-NodeJS APIs.&lt;/p&gt;&lt;p class=&quot;css-ocxwk4&quot;&gt;HAP-NodeJS is meant to run as a single server instance as opposed to a separate instance for each accessory. Therefore, the accessory code for this module is written to be integrated into a HAP-NodeJS instance as opposed to standing on its own.&lt;/p&gt;&lt;h4 class=&quot;css-1pmnorg&quot;&gt;BLE framework&lt;/h4&gt;&lt;p class=&quot;css-ocxwk4&quot;&gt;To listen for BLE broadcasts, I used the &lt;a href=&quot;https://github.com/sandeepmistry/noble&quot; class=&quot;css-1i9b1eb&quot;&gt;&lt;code class=&quot;css-0&quot;&gt;noble&lt;/code&gt; module&lt;/a&gt;, which was the only complete node.js BLE implementation I could find. &lt;code class=&quot;css-0&quot;&gt;noble&lt;/code&gt; is well designed and generally easy to work with, although as of this writing it does not yet support the latest version of macOS.&lt;/p&gt;&lt;h3 class=&quot;css-3omw84&quot;&gt;Using it yourself&lt;/h3&gt;&lt;p class=&quot;css-ocxwk4&quot;&gt;&lt;em class=&quot;css-0&quot;&gt;The following is copied from the &lt;a href=&quot;https://github.com/danielpgross/homekit-ble-temp-humid-sensor/blob/master/bridge/README.md&quot; class=&quot;css-1i9b1eb&quot;&gt;README file in the source code repository&lt;/a&gt;. Please see that file to keep up to date with any changes.&lt;/em&gt;&lt;/p&gt;&lt;p class=&quot;css-ocxwk4&quot;&gt;The code is a node.js module that is written to be integrated into an instance of &lt;a href=&quot;https://github.com/KhaosT/HAP-NodeJS&quot; class=&quot;css-1i9b1eb&quot;&gt;HAP-NodeJS&lt;/a&gt;.&lt;/p&gt;&lt;h4 class=&quot;css-1pmnorg&quot;&gt;Requirements&lt;/h4&gt;&lt;p class=&quot;css-ocxwk4&quot;&gt;The following applications and libraries need to be present in order for this module to work:&lt;/p&gt;&lt;ul class=&quot;css-aq9zkf&quot;&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-ocxwk4&quot;&gt;node.js and npm&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-ocxwk4&quot;&gt;Libraries for building HomeKit and Bluetooth components. These can be installed on Ubuntu/Debian using: &lt;/p&gt;&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;&quot;&gt;&lt;pre class=&quot;prism-code language-&quot; style=&quot;color:#d6deeb;background-color:#011627&quot; data-linenumber=&quot;true&quot;&gt;&lt;button type=&quot;button&quot; name=&quot;copy code to clipboard&quot; class=&quot;code-copy-button css-1heep1n&quot;&gt;Copy&lt;span aria-roledescription=&quot;status&quot; class=&quot;css-1gy8470&quot;&gt;copy code to clipboard&lt;/span&gt;&lt;/button&gt;&lt;code class=&quot;language-&quot;&gt;&lt;div class=&quot;token-line&quot; style=&quot;color:#d6deeb&quot;&gt;&lt;span class=&quot;line-number-style&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token plain&quot;&gt;apt-get install build-essential python libavahi-compat-libdnssd-dev&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;token-line&quot; style=&quot;color:#d6deeb&quot;&gt;&lt;span class=&quot;line-number-style&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;token plain&quot;&gt;npm install -g node-gyp&lt;/span&gt;&lt;/div&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/li&gt;&lt;/ul&gt;&lt;h4 class=&quot;css-1pmnorg&quot;&gt;Installation&lt;/h4&gt;&lt;p class=&quot;css-ocxwk4&quot;&gt;If you have an instance of HAP-NodeJS, you can skip to step 3.&lt;/p&gt;&lt;ol class=&quot;css-aq9zkf&quot;&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-ocxwk4&quot;&gt;Install HAP-NodeJS.&lt;/p&gt;&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;&quot;&gt;&lt;pre class=&quot;prism-code language-&quot; style=&quot;color:#d6deeb;background-color:#011627&quot; data-linenumber=&quot;true&quot;&gt;&lt;button type=&quot;button&quot; name=&quot;copy code to clipboard&quot; class=&quot;code-copy-button css-1heep1n&quot;&gt;Copy&lt;span aria-roledescription=&quot;status&quot; class=&quot;css-1gy8470&quot;&gt;copy code to clipboard&lt;/span&gt;&lt;/button&gt;&lt;code class=&quot;language-&quot;&gt;&lt;div class=&quot;token-line&quot; style=&quot;color:#d6deeb&quot;&gt;&lt;span class=&quot;line-number-style&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token plain&quot;&gt;git clone https://github.com/KhaosT/HAP-NodeJS.git&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;token-line&quot; style=&quot;color:#d6deeb&quot;&gt;&lt;span class=&quot;line-number-style&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;token plain&quot;&gt;cd HAP-NodeJS&lt;/span&gt;&lt;/div&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-ocxwk4&quot;&gt;(recommended) Remove sample accessories from HAP-NodeJS instance.&lt;/p&gt;&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;&quot;&gt;&lt;pre class=&quot;prism-code language-&quot; style=&quot;color:#d6deeb;background-color:#011627&quot; data-linenumber=&quot;true&quot;&gt;&lt;button type=&quot;button&quot; name=&quot;copy code to clipboard&quot; class=&quot;code-copy-button css-1heep1n&quot;&gt;Copy&lt;span aria-roledescription=&quot;status&quot; class=&quot;css-1gy8470&quot;&gt;copy code to clipboard&lt;/span&gt;&lt;/button&gt;&lt;code class=&quot;language-&quot;&gt;&lt;div class=&quot;token-line&quot; style=&quot;color:#d6deeb&quot;&gt;&lt;span class=&quot;line-number-style&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token plain&quot;&gt;rm accessories/*_accessory.js&lt;/span&gt;&lt;/div&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-ocxwk4&quot;&gt;Copy TempHumidSensor_accessory.js into accessories folder.&lt;/p&gt;&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;&quot;&gt;&lt;pre class=&quot;prism-code language-&quot; style=&quot;color:#d6deeb;background-color:#011627&quot; data-linenumber=&quot;true&quot;&gt;&lt;button type=&quot;button&quot; name=&quot;copy code to clipboard&quot; class=&quot;code-copy-button css-1heep1n&quot;&gt;Copy&lt;span aria-roledescription=&quot;status&quot; class=&quot;css-1gy8470&quot;&gt;copy code to clipboard&lt;/span&gt;&lt;/button&gt;&lt;code class=&quot;language-&quot;&gt;&lt;div class=&quot;token-line&quot; style=&quot;color:#d6deeb&quot;&gt;&lt;span class=&quot;line-number-style&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token plain&quot;&gt;cp /path/to/repo/bridge/TempHumidSensor_accessory.js accessories/&lt;/span&gt;&lt;/div&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-ocxwk4&quot;&gt;Install node modules.&lt;/p&gt;&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;&quot;&gt;&lt;pre class=&quot;prism-code language-&quot; style=&quot;color:#d6deeb;background-color:#011627&quot; data-linenumber=&quot;true&quot;&gt;&lt;button type=&quot;button&quot; name=&quot;copy code to clipboard&quot; class=&quot;code-copy-button css-1heep1n&quot;&gt;Copy&lt;span aria-roledescription=&quot;status&quot; class=&quot;css-1gy8470&quot;&gt;copy code to clipboard&lt;/span&gt;&lt;/button&gt;&lt;code class=&quot;language-&quot;&gt;&lt;div class=&quot;token-line&quot; style=&quot;color:#d6deeb&quot;&gt;&lt;span class=&quot;line-number-style&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token plain&quot;&gt;npm install&lt;/span&gt;&lt;/div&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-ocxwk4&quot;&gt;Manually install the &lt;code class=&quot;css-0&quot;&gt;noble&lt;/code&gt; BLE module in the HAP-NodeJS root. This is required for the temperature/humidity accessory.&lt;/p&gt;&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;&quot;&gt;&lt;pre class=&quot;prism-code language-&quot; style=&quot;color:#d6deeb;background-color:#011627&quot; data-linenumber=&quot;true&quot;&gt;&lt;button type=&quot;button&quot; name=&quot;copy code to clipboard&quot; class=&quot;code-copy-button css-1heep1n&quot;&gt;Copy&lt;span aria-roledescription=&quot;status&quot; class=&quot;css-1gy8470&quot;&gt;copy code to clipboard&lt;/span&gt;&lt;/button&gt;&lt;code class=&quot;language-&quot;&gt;&lt;div class=&quot;token-line&quot; style=&quot;color:#d6deeb&quot;&gt;&lt;span class=&quot;line-number-style&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token plain&quot;&gt;npm install noble&lt;/span&gt;&lt;/div&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;p class=&quot;css-ocxwk4&quot;&gt;Finally, start HAP-NodeJS.&lt;/p&gt;&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;&quot;&gt;&lt;pre class=&quot;prism-code language-&quot; style=&quot;color:#d6deeb;background-color:#011627&quot; data-linenumber=&quot;true&quot;&gt;&lt;button type=&quot;button&quot; name=&quot;copy code to clipboard&quot; class=&quot;code-copy-button css-1heep1n&quot;&gt;Copy&lt;span aria-roledescription=&quot;status&quot; class=&quot;css-1gy8470&quot;&gt;copy code to clipboard&lt;/span&gt;&lt;/button&gt;&lt;code class=&quot;language-&quot;&gt;&lt;div class=&quot;token-line&quot; style=&quot;color:#d6deeb&quot;&gt;&lt;span class=&quot;line-number-style&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token plain&quot;&gt;node Core.js&lt;/span&gt;&lt;/div&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/li&gt;&lt;/ol&gt;&lt;h2 class=&quot;css-992wu8&quot;&gt;End-to-end demonstration&lt;/h2&gt;&lt;p class=&quot;css-ocxwk4&quot;&gt;At last! We&amp;#x27;ve completed building the hardware and software for the project and it&amp;#x27;s time to see the fruits of our efforts. Once you&amp;#x27;ve followed the instructions in the above sections to get the sensor and bridge modules running, the final step is to complete accessory pairing in the Home app on your iOS device.&lt;/p&gt;&lt;ol class=&quot;css-aq9zkf&quot;&gt;&lt;li class=&quot;css-0&quot;&gt;Turn on the sensor by connecting it to power.&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;Activate the bridge module by starting HAP-NodeJS (see above).&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;On your iOS device, open the &amp;quot;Home&amp;quot; app and follow along with the steps below:&lt;/li&gt;&lt;/ol&gt;&lt;div style=&quot;display:flex;flex-wrap:wrap;overflow:auto&quot;&gt;&lt;div style=&quot;max-width:250px;margin:1em&quot;&gt;&lt;img src=&quot;static/hk-pairing-1-9a53716d232f224c023a39bad1f2386d.png&quot; style=&quot;max-width:100%&quot; alt=&quot;Pairing step 1&quot;/&gt;&lt;div&gt;&lt;p&gt;Press &amp;quot;Add Accessory&amp;quot;&lt;/p&gt;&lt;/div&gt;&lt;/div&gt;&lt;div style=&quot;max-width:250px;margin:1em&quot;&gt;&lt;img src=&quot;static/hk-pairing-2-32f0db1778bc7e73b91680c960b9d19d.png&quot; style=&quot;max-width:100%&quot; alt=&quot;Pairing step 2&quot;/&gt;&lt;div&gt;&lt;p&gt;Press &amp;quot;Temperature Humidity Sensor&amp;quot;&lt;/p&gt;&lt;/div&gt;&lt;/div&gt;&lt;div style=&quot;max-width:250px;margin:1em&quot;&gt;&lt;img src=&quot;static/hk-pairing-3-a9e2ba6dd9d819b0ff3af2a9eb5c4331.png&quot; style=&quot;max-width:100%&quot; alt=&quot;Pairing step 3&quot;/&gt;&lt;div&gt;&lt;p&gt;When prompted, click &amp;quot;Add Anyway&amp;quot;. Enter the HomeKit Code that&amp;#x27;s hardcoded, the default is 031-45-154.&lt;/p&gt;&lt;/div&gt;&lt;/div&gt;&lt;div style=&quot;max-width:250px;margin:1em&quot;&gt;&lt;img src=&quot;static/hk-pairing-4-31cd8318a28174199f25a04bb55d6b7c.png&quot; style=&quot;max-width:100%&quot; alt=&quot;Pairing step 4&quot;/&gt;&lt;div&gt;&lt;p&gt;&lt;/p&gt;&lt;/div&gt;&lt;/div&gt;&lt;div style=&quot;max-width:250px;margin:1em&quot;&gt;&lt;img src=&quot;static/hk-pairing-5-95393215940ffecfba64c770364e7f83.png&quot; style=&quot;max-width:100%&quot; alt=&quot;Pairing step 5&quot;/&gt;&lt;div&gt;&lt;p&gt;&lt;/p&gt;&lt;/div&gt;&lt;/div&gt;&lt;div style=&quot;max-width:250px;margin:1em&quot;&gt;&lt;img src=&quot;static/hk-pairing-6-0552665da7008d8bad3e34a362ab594c.png&quot; style=&quot;max-width:100%&quot; alt=&quot;Pairing step 6&quot;/&gt;&lt;div&gt;&lt;p&gt;You should now see 2 new accessories and the humidity and temperature displayed at the top!&lt;/p&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;p class=&quot;css-ocxwk4&quot;&gt;Thank you for reading this series of posts!&lt;/p&gt;</content:encoded></item><item><title><![CDATA[Building a battery-powered wireless sensor using Bluetooth Low-Energy (BLE) and Apple HomeKit (Part 2)]]></title><link>https://dgross.ca/blog/ble-homekit-sensor-pt2</link><guid isPermaLink="false">https://dgross.ca/blog/ble-homekit-sensor-pt2</guid><pubDate>Tue, 04 Jul 2017 04:00:00 GMT</pubDate><content:encoded>&lt;style data-emotion-css=&quot;9096aj&quot;&gt;body{--theme-ui-colors-transparent:var(--theme-ui-colors-transparent,transparent);--theme-ui-colors-black:var(--theme-ui-colors-black,#000);--theme-ui-colors-white:var(--theme-ui-colors-white,#fff);--theme-ui-colors-gray-0:var(--theme-ui-colors-gray-0,null);--theme-ui-colors-gray-1:var(--theme-ui-colors-gray-1,#f7fafc);--theme-ui-colors-gray-2:var(--theme-ui-colors-gray-2,#edf2f7);--theme-ui-colors-gray-3:var(--theme-ui-colors-gray-3,#e2e8f0);--theme-ui-colors-gray-4:var(--theme-ui-colors-gray-4,#cbd5e0);--theme-ui-colors-gray-5:var(--theme-ui-colors-gray-5,#a0aec0);--theme-ui-colors-gray-6:var(--theme-ui-colors-gray-6,#718096);--theme-ui-colors-gray-7:var(--theme-ui-colors-gray-7,#4a5568);--theme-ui-colors-gray-8:var(--theme-ui-colors-gray-8,#2d3748);--theme-ui-colors-gray-9:var(--theme-ui-colors-gray-9,#1a202c);--theme-ui-colors-red-0:var(--theme-ui-colors-red-0,null);--theme-ui-colors-red-1:var(--theme-ui-colors-red-1,#fff5f5);--theme-ui-colors-red-2:var(--theme-ui-colors-red-2,#fed7d7);--theme-ui-colors-red-3:var(--theme-ui-colors-red-3,#feb2b2);--theme-ui-colors-red-4:var(--theme-ui-colors-red-4,#fc8181);--theme-ui-colors-red-5:var(--theme-ui-colors-red-5,#f56565);--theme-ui-colors-red-6:var(--theme-ui-colors-red-6,#e53e3e);--theme-ui-colors-red-7:var(--theme-ui-colors-red-7,#c53030);--theme-ui-colors-red-8:var(--theme-ui-colors-red-8,#9b2c2c);--theme-ui-colors-red-9:var(--theme-ui-colors-red-9,#742a2a);--theme-ui-colors-orange-0:var(--theme-ui-colors-orange-0,null);--theme-ui-colors-orange-1:var(--theme-ui-colors-orange-1,#fffaf0);--theme-ui-colors-orange-2:var(--theme-ui-colors-orange-2,#feebc8);--theme-ui-colors-orange-3:var(--theme-ui-colors-orange-3,#fbd38d);--theme-ui-colors-orange-4:var(--theme-ui-colors-orange-4,#f6ad55);--theme-ui-colors-orange-5:var(--theme-ui-colors-orange-5,#ed8936);--theme-ui-colors-orange-6:var(--theme-ui-colors-orange-6,#dd6b20);--theme-ui-colors-orange-7:var(--theme-ui-colors-orange-7,#c05621);--theme-ui-colors-orange-8:var(--theme-ui-colors-orange-8,#9c4221);--theme-ui-colors-orange-9:var(--theme-ui-colors-orange-9,#7b341e);--theme-ui-colors-yellow-0:var(--theme-ui-colors-yellow-0,null);--theme-ui-colors-yellow-1:var(--theme-ui-colors-yellow-1,#fffff0);--theme-ui-colors-yellow-2:var(--theme-ui-colors-yellow-2,#fefcbf);--theme-ui-colors-yellow-3:var(--theme-ui-colors-yellow-3,#faf089);--theme-ui-colors-yellow-4:var(--theme-ui-colors-yellow-4,#f6e05e);--theme-ui-colors-yellow-5:var(--theme-ui-colors-yellow-5,#ecc94b);--theme-ui-colors-yellow-6:var(--theme-ui-colors-yellow-6,#d69e2e);--theme-ui-colors-yellow-7:var(--theme-ui-colors-yellow-7,#b7791f);--theme-ui-colors-yellow-8:var(--theme-ui-colors-yellow-8,#975a16);--theme-ui-colors-yellow-9:var(--theme-ui-colors-yellow-9,#744210);--theme-ui-colors-green-0:var(--theme-ui-colors-green-0,null);--theme-ui-colors-green-1:var(--theme-ui-colors-green-1,#f0fff4);--theme-ui-colors-green-2:var(--theme-ui-colors-green-2,#c6f6d5);--theme-ui-colors-green-3:var(--theme-ui-colors-green-3,#9ae6b4);--theme-ui-colors-green-4:var(--theme-ui-colors-green-4,#68d391);--theme-ui-colors-green-5:var(--theme-ui-colors-green-5,#48bb78);--theme-ui-colors-green-6:var(--theme-ui-colors-green-6,#38a169);--theme-ui-colors-green-7:var(--theme-ui-colors-green-7,#2f855a);--theme-ui-colors-green-8:var(--theme-ui-colors-green-8,#276749);--theme-ui-colors-green-9:var(--theme-ui-colors-green-9,#22543d);--theme-ui-colors-teal-0:var(--theme-ui-colors-teal-0,null);--theme-ui-colors-teal-1:var(--theme-ui-colors-teal-1,#e6fffa);--theme-ui-colors-teal-2:var(--theme-ui-colors-teal-2,#b2f5ea);--theme-ui-colors-teal-3:var(--theme-ui-colors-teal-3,#81e6d9);--theme-ui-colors-teal-4:var(--theme-ui-colors-teal-4,#4fd1c5);--theme-ui-colors-teal-5:var(--theme-ui-colors-teal-5,#38b2ac);--theme-ui-colors-teal-6:var(--theme-ui-colors-teal-6,#319795);--theme-ui-colors-teal-7:var(--theme-ui-colors-teal-7,#2c7a7b);--theme-ui-colors-teal-8:var(--theme-ui-colors-teal-8,#285e61);--theme-ui-colors-teal-9:var(--theme-ui-colors-teal-9,#234e52);--theme-ui-colors-blue-0:var(--theme-ui-colors-blue-0,null);--theme-ui-colors-blue-1:var(--theme-ui-colors-blue-1,#ebf8ff);--theme-ui-colors-blue-2:var(--theme-ui-colors-blue-2,#bee3f8);--theme-ui-colors-blue-3:var(--theme-ui-colors-blue-3,#90cdf4);--theme-ui-colors-blue-4:var(--theme-ui-colors-blue-4,#63b3ed);--theme-ui-colors-blue-5:var(--theme-ui-colors-blue-5,#4299e1);--theme-ui-colors-blue-6:var(--theme-ui-colors-blue-6,#3182ce);--theme-ui-colors-blue-7:var(--theme-ui-colors-blue-7,#2b6cb0);--theme-ui-colors-blue-8:var(--theme-ui-colors-blue-8,#2c5282);--theme-ui-colors-blue-9:var(--theme-ui-colors-blue-9,#2a4365);--theme-ui-colors-indigo-0:var(--theme-ui-colors-indigo-0,null);--theme-ui-colors-indigo-1:var(--theme-ui-colors-indigo-1,#ebf4ff);--theme-ui-colors-indigo-2:var(--theme-ui-colors-indigo-2,#c3dafe);--theme-ui-colors-indigo-3:var(--theme-ui-colors-indigo-3,#a3bffa);--theme-ui-colors-indigo-4:var(--theme-ui-colors-indigo-4,#7f9cf5);--theme-ui-colors-indigo-5:var(--theme-ui-colors-indigo-5,#667eea);--theme-ui-colors-indigo-6:var(--theme-ui-colors-indigo-6,#5a67d8);--theme-ui-colors-indigo-7:var(--theme-ui-colors-indigo-7,#4c51bf);--theme-ui-colors-indigo-8:var(--theme-ui-colors-indigo-8,#434190);--theme-ui-colors-indigo-9:var(--theme-ui-colors-indigo-9,#3c366b);--theme-ui-colors-purple-0:var(--theme-ui-colors-purple-0,null);--theme-ui-colors-purple-1:var(--theme-ui-colors-purple-1,#faf5ff);--theme-ui-colors-purple-2:var(--theme-ui-colors-purple-2,#e9d8fd);--theme-ui-colors-purple-3:var(--theme-ui-colors-purple-3,#d6bcfa);--theme-ui-colors-purple-4:var(--theme-ui-colors-purple-4,#b794f4);--theme-ui-colors-purple-5:var(--theme-ui-colors-purple-5,#9f7aea);--theme-ui-colors-purple-6:var(--theme-ui-colors-purple-6,#805ad5);--theme-ui-colors-purple-7:var(--theme-ui-colors-purple-7,#6b46c1);--theme-ui-colors-purple-8:var(--theme-ui-colors-purple-8,#553c9a);--theme-ui-colors-purple-9:var(--theme-ui-colors-purple-9,#44337a);--theme-ui-colors-pink-0:var(--theme-ui-colors-pink-0,null);--theme-ui-colors-pink-1:var(--theme-ui-colors-pink-1,#fff5f7);--theme-ui-colors-pink-2:var(--theme-ui-colors-pink-2,#fed7e2);--theme-ui-colors-pink-3:var(--theme-ui-colors-pink-3,#fbb6ce);--theme-ui-colors-pink-4:var(--theme-ui-colors-pink-4,#f687b3);--theme-ui-colors-pink-5:var(--theme-ui-colors-pink-5,#ed64a6);--theme-ui-colors-pink-6:var(--theme-ui-colors-pink-6,#d53f8c);--theme-ui-colors-pink-7:var(--theme-ui-colors-pink-7,#b83280);--theme-ui-colors-pink-8:var(--theme-ui-colors-pink-8,#97266d);--theme-ui-colors-pink-9:var(--theme-ui-colors-pink-9,#702459);--theme-ui-colors-grayDark:var(--theme-ui-colors-grayDark,#2d3748);--theme-ui-colors-text:var(--theme-ui-colors-text,#2d3748);--theme-ui-colors-background:var(--theme-ui-colors-background,#fff);--theme-ui-colors-primary:var(--theme-ui-colors-primary,#2b6cb0);--theme-ui-colors-primaryHover:var(--theme-ui-colors-primaryHover,#2c5282);--theme-ui-colors-secondary:var(--theme-ui-colors-secondary,#718096);--theme-ui-colors-muted:var(--theme-ui-colors-muted,#e2e8f0);--theme-ui-colors-success:var(--theme-ui-colors-success,#9ae6b4);--theme-ui-colors-info:var(--theme-ui-colors-info,#63b3ed);--theme-ui-colors-warning:var(--theme-ui-colors-warning,#faf089);--theme-ui-colors-danger:var(--theme-ui-colors-danger,#feb2b2);--theme-ui-colors-light:var(--theme-ui-colors-light,#f7fafc);--theme-ui-colors-dark:var(--theme-ui-colors-dark,#2d3748);--theme-ui-colors-textMuted:var(--theme-ui-colors-textMuted,#718096);--theme-ui-colors-toggleIcon:var(--theme-ui-colors-toggleIcon,#2d3748);--theme-ui-colors-heading:var(--theme-ui-colors-heading,#000);--theme-ui-colors-divide:var(--theme-ui-colors-divide,#cbd5e0);color:var(--theme-ui-colors-text,#2d3748);background-color:var(--theme-ui-colors-background,#fff);}body.theme-ui-dark{--theme-ui-colors-text:var(--theme-ui-colors-modes-dark-text,#cbd5e0);--theme-ui-colors-primary:var(--theme-ui-colors-modes-dark-primary,#63b3ed);--theme-ui-colors-secondary:var(--theme-ui-colors-modes-dark-secondary,#7f8ea3);--theme-ui-colors-toggleIcon:var(--theme-ui-colors-modes-dark-toggleIcon,#cbd5e0);--theme-ui-colors-background:var(--theme-ui-colors-modes-dark-background,#1A202C);--theme-ui-colors-heading:var(--theme-ui-colors-modes-dark-heading,#fff);--theme-ui-colors-divide:var(--theme-ui-colors-modes-dark-divide,#2d3748);--theme-ui-colors-muted:var(--theme-ui-colors-modes-dark-muted,#2d3748);}&lt;/style&gt;&lt;style data-emotion-css=&quot;tm2q0o&quot;&gt;*{box-sizing:border-box;}body{margin:0;font-family:&quot;IBM Plex Sans&quot;,-apple-system,BlinkMacSystemFont,&quot;Segoe UI&quot;,Roboto,&quot;Helvetica Neue&quot;,Arial,&quot;Noto Sans&quot;,sans-serif,&quot;Apple Color Emoji&quot;,&quot;Segoe UI Emoji&quot;,&quot;Segoe UI Symbol&quot;,&quot;Noto Color Emoji&quot;;line-height:1.625;font-weight:400;color:var(--theme-ui-colors-text,#2d3748);background-color:var(--theme-ui-colors-background,#fff);padding:0;box-sizing:border-box;text-rendering:optimizeLegibility;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;}&lt;/style&gt;&lt;style data-emotion-css=&quot;ocxwk4&quot;&gt;.css-ocxwk4{font-size:1rem;-webkit-letter-spacing:-0.003em;-moz-letter-spacing:-0.003em;-ms-letter-spacing:-0.003em;letter-spacing:-0.003em;line-height:1.625;--baseline-multiplier:0.179;--x-height-multiplier:0.35;word-break:break-word;}@media screen and (min-width:640px){.css-ocxwk4{font-size:1rem;}}@media screen and (min-width:768px){.css-ocxwk4{font-size:1.1rem;}}&lt;/style&gt;&lt;p class=&quot;css-ocxwk4&quot;&gt;&lt;em class=&quot;css-0&quot;&gt;This is the second post in a series about building a simple wireless temperature and humidity sensor using inexpensive components, Bluetooth Low Energy (BLE) for communication, and Apple HomeKit to read sensor values. For the first post, see &lt;style data-emotion-css=&quot;1i9b1eb&quot;&gt;.css-1i9b1eb{color:var(--theme-ui-colors-primary,#2b6cb0);-webkit-text-decoration:none;text-decoration:none;}.css-1i9b1eb:hover{-webkit-text-decoration:underline;text-decoration:underline;}&lt;/style&gt;&lt;a href=&quot;/blog/ble-homekit-sensor-pt1&quot; class=&quot;css-1i9b1eb&quot;&gt;Part 1&lt;/a&gt;&lt;/em&gt;.&lt;/p&gt;&lt;p class=&quot;css-ocxwk4&quot;&gt;In the previous post, we covered the &lt;strong class=&quot;css-0&quot;&gt;motivation for this project&lt;/strong&gt; and &lt;strong class=&quot;css-0&quot;&gt;considered a few high-level designs&lt;/strong&gt;, choosing the one that seemed best. Now that we have the main high-level design questions out of the way, let&amp;#x27;s get into implementation details.&lt;/p&gt;&lt;style data-emotion-css=&quot;992wu8&quot;&gt;.css-992wu8{font-family:inherit;font-weight:500;line-height:1.25;margin:0;margin-bottom:0.25rem;font-size:1.6rem;margin-top:2rem;color:var(--theme-ui-colors-heading,#000);}@media screen and (min-width:640px){.css-992wu8{font-size:1.8rem;}}@media screen and (min-width:768px){.css-992wu8{font-size:1.8rem;}}@media screen and (min-width:1024px){.css-992wu8{font-size:2rem;}}&lt;/style&gt;&lt;h2 class=&quot;css-992wu8&quot;&gt;Hardware selection&lt;/h2&gt;&lt;p class=&quot;css-ocxwk4&quot;&gt;Our sensor setup consists of 2 main modules:&lt;/p&gt;&lt;style data-emotion-css=&quot;aq9zkf&quot;&gt;.css-aq9zkf li{font-size:1rem;-webkit-letter-spacing:-0.003em;-moz-letter-spacing:-0.003em;-ms-letter-spacing:-0.003em;letter-spacing:-0.003em;line-height:1.625;--baseline-multiplier:0.179;--x-height-multiplier:0.35;}@media screen and (min-width:640px){.css-aq9zkf li{font-size:1rem;}}@media screen and (min-width:768px){.css-aq9zkf li{font-size:1.1rem;}}&lt;/style&gt;&lt;ol class=&quot;css-aq9zkf&quot;&gt;&lt;li class=&quot;css-0&quot;&gt;The sensor itself, to be located where temperature and humidity are to be measured.&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;An HAP bridge, to be located somewhere within communication range of the sensor (up to ~100m).&lt;/li&gt;&lt;/ol&gt;&lt;p class=&quot;css-ocxwk4&quot;&gt;Let&amp;#x27;s take a closer look at the hardware components comprising each of these modules.&lt;/p&gt;&lt;style data-emotion-css=&quot;3omw84&quot;&gt;.css-3omw84{font-family:inherit;font-weight:500;line-height:1.25;margin:0;margin-bottom:0.25rem;font-size:1.3rem;margin-top:2rem;color:var(--theme-ui-colors-heading,#000);}@media screen and (min-width:640px){.css-3omw84{font-size:1.6rem;}}@media screen and (min-width:768px){.css-3omw84{font-size:1.6rem;}}@media screen and (min-width:1024px){.css-3omw84{font-size:1.8rem;}}&lt;/style&gt;&lt;h3 class=&quot;css-3omw84&quot;&gt;Sensor&lt;/h3&gt;&lt;p class=&quot;css-ocxwk4&quot;&gt;The sensor module has 2 main hardware components:&lt;/p&gt;&lt;ol class=&quot;css-aq9zkf&quot;&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;strong class=&quot;css-0&quot;&gt;BLE SoC (System-on-a-chip)&lt;/strong&gt; -- for managing bluetooth communication&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;&lt;strong class=&quot;css-0&quot;&gt;Temperature/Humidity sensor&lt;/strong&gt; -- for (you guessed it!) sensing temperature and humidity&lt;/li&gt;&lt;/ol&gt;&lt;style data-emotion-css=&quot;1pmnorg&quot;&gt;.css-1pmnorg{font-family:inherit;font-weight:500;line-height:1.25;margin:0;margin-bottom:0.25rem;font-size:1.1rem;color:var(--theme-ui-colors-heading,#000);margin-top:1rem;}@media screen and (min-width:640px){.css-1pmnorg{font-size:1.3rem;}}@media screen and (min-width:768px){.css-1pmnorg{font-size:1.3rem;}}@media screen and (min-width:1024px){.css-1pmnorg{font-size:1.6rem;}}&lt;/style&gt;&lt;h4 class=&quot;css-1pmnorg&quot;&gt;BLE SoC&lt;/h4&gt;&lt;p class=&quot;css-ocxwk4&quot;&gt;In the first post of this series, I explained that I had chosen the &lt;a href=&quot;https://www.nordicsemi.com/eng/Products/Bluetooth-low-energy/nRF52832&quot; class=&quot;css-1i9b1eb&quot;&gt;Nordic Semiconductor nRF52832&lt;/a&gt;. This is one amazing little chip -- it packs considerable processing power, with extremely low power requirements, and at a low cost. Here are some of its key specs:&lt;/p&gt;&lt;ul class=&quot;css-aq9zkf&quot;&gt;&lt;li class=&quot;css-0&quot;&gt;32-bit ARM Cortex-M4F Processor @ 64MHz&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;1.7v to 3.6v operation&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;512kB flash + 64kB RAM&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;96dBm sensitivity&lt;/li&gt;&lt;/ul&gt;&lt;p class=&quot;css-ocxwk4&quot;&gt;The nRF52 is available as an IC only for an easy &lt;a href=&quot;https://www.digikey.com/products/en/rf-if-and-rfid/rf-transceiver-ics/879?k=nRF52832&quot; class=&quot;css-1i9b1eb&quot;&gt;$2.50 a piece&lt;/a&gt; in a &lt;a href=&quot;https://en.wikipedia.org/wiki/Quad_Flat_No-leads_package&quot; class=&quot;css-1i9b1eb&quot;&gt;flat no-leads&lt;/a&gt; package, but for prototyping purposes, you&amp;#x27;ll want to work with a breakout board. There are a bunch of nRF52 prototyping boards on the market, including the ones below:&lt;/p&gt;&lt;style data-emotion-css=&quot;f4lqjx&quot;&gt;.css-f4lqjx{width:100%;margin-top:2rem;margin-bottom:2rem;border-collapse:separate;border-spacing:0;}.css-f4lqjx th,.css-f4lqjx td{text-align:left;padding-top:4px;padding-bottom:4px;padding-right:4px;padding-left:0;border-color:var(--theme-ui-colors-muted,#e2e8f0);border-bottom-style:solid;}&lt;/style&gt;&lt;table class=&quot;css-f4lqjx&quot;&gt;&lt;thead&gt;&lt;tr class=&quot;css-0&quot;&gt;&lt;style data-emotion-css=&quot;18ma8h6&quot;&gt;.css-18ma8h6{vertical-align:bottom;border-bottom-width:2px;color:var(--theme-ui-colors-heading,#000);}&lt;/style&gt;&lt;th class=&quot;css-18ma8h6&quot;&gt;Manufacturer&lt;/th&gt;&lt;th class=&quot;css-18ma8h6&quot;&gt;Model&lt;/th&gt;&lt;th class=&quot;css-18ma8h6&quot;&gt;Price&lt;/th&gt;&lt;/tr&gt;&lt;/thead&gt;&lt;tbody&gt;&lt;tr class=&quot;css-0&quot;&gt;&lt;style data-emotion-css=&quot;15msde0&quot;&gt;.css-15msde0{vertical-align:top;border-bottom-width:1px;}&lt;/style&gt;&lt;td class=&quot;css-15msde0&quot;&gt;SparkFun&lt;/td&gt;&lt;td class=&quot;css-15msde0&quot;&gt;&lt;a href=&quot;https://www.sparkfun.com/products/13990&quot; class=&quot;css-1i9b1eb&quot;&gt;WRL-13990&lt;/a&gt;&lt;/td&gt;&lt;td class=&quot;css-15msde0&quot;&gt;$19.95&lt;/td&gt;&lt;/tr&gt;&lt;tr class=&quot;css-0&quot;&gt;&lt;td class=&quot;css-15msde0&quot;&gt;RedBear&lt;/td&gt;&lt;td class=&quot;css-15msde0&quot;&gt;&lt;a href=&quot;https://redbear.cc/product/ble-nano-2.html&quot; class=&quot;css-1i9b1eb&quot;&gt;BLE Nano v2&lt;/a&gt;&lt;/td&gt;&lt;td class=&quot;css-15msde0&quot;&gt;$16.90&lt;/td&gt;&lt;/tr&gt;&lt;tr class=&quot;css-0&quot;&gt;&lt;td class=&quot;css-15msde0&quot;&gt;Nordic&lt;/td&gt;&lt;td class=&quot;css-15msde0&quot;&gt;&lt;a href=&quot;https://www.nordicsemi.com/eng/Products/Bluetooth-low-energy/nRF52-DK&quot; class=&quot;css-1i9b1eb&quot;&gt;nRF52 DK (development kit)&lt;/a&gt;&lt;/td&gt;&lt;td class=&quot;css-15msde0&quot;&gt;$39.00&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;p class=&quot;css-ocxwk4&quot;&gt;I chose the SparkFun WRL-13990, for a few reasons:&lt;/p&gt;&lt;ul class=&quot;css-aq9zkf&quot;&gt;&lt;li class=&quot;css-0&quot;&gt;It has &lt;a href=&quot;https://learn.sparkfun.com/tutorials/nrf52832-breakout-board-hookup-guide?_ga=2.249486336.665477030.1498608245-1887958815.1498608245&quot; class=&quot;css-1i9b1eb&quot;&gt;solid, easy-to-read documentation&lt;/a&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;It comes pre-programmed with a serial bootloader. That means that it can be programmed using a simple USB-to-serial converter instead of a more complex and expensive JTAG programmer. It also has its pins arranged so that it can be easily attached to such a USB-to-serial programmer.&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;It&amp;#x27;s compatible with the Arduino IDE. &lt;strong class=&quot;css-0&quot;&gt;This adds the huge benefit that existing Arduino libraries and samples can run on the chip.&lt;/strong&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;It&amp;#x27;s relatively inexpensive&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;It has LEDs and buttons for easy debugging&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;It has a small form factor (especially in comparison to the nRF52 DK)&lt;/li&gt;&lt;/ul&gt;&lt;p class=&quot;css-ocxwk4&quot;&gt;I predicted that programming the nRF5 would be one of the most challenging parts of the project, and I chose the WRL-13990 in hopes that it would greatly simplify this process.&lt;/p&gt;&lt;p class=&quot;css-ocxwk4&quot;&gt;One important note about the WRL-13990 is that it comes &lt;em class=&quot;css-0&quot;&gt;without headers attached&lt;/em&gt;. In order to use it in this project, &lt;strong class=&quot;css-0&quot;&gt;the headers need to be soldered on&lt;/strong&gt;, which requires basic soldering tools and skills. If this is a dealbreaker for you, you might want to consider another board instead.&lt;/p&gt;&lt;h4 class=&quot;css-1pmnorg&quot;&gt;Temperature/Humidity sensor&lt;/h4&gt;&lt;p class=&quot;css-ocxwk4&quot;&gt;I chose a &lt;a href=&quot;https://www.adafruit.com/product/385&quot; class=&quot;css-1i9b1eb&quot;&gt;DHT-22&lt;/a&gt; temperature/humidity sensor because it has extremely wide support, discussion, and documentation within the Arduino community. I chose it over the lower-cost &lt;a href=&quot;https://www.adafruit.com/product/386&quot; class=&quot;css-1i9b1eb&quot;&gt;DHT-11&lt;/a&gt; because of its higher sensor-reading precision.&lt;/p&gt;&lt;h4 class=&quot;css-1pmnorg&quot;&gt;USB-to-serial programmer&lt;/h4&gt;&lt;p class=&quot;css-ocxwk4&quot;&gt;Although strictly speaking it&amp;#x27;s not part of the sensor, a USB-to-serial (sometimes called USB-to-TTL) programmer chip is needed to program software into the nRF52. USB-to-serial chips are very cheap and easily available, with a few ICs forming the core of different PCB variations in the market. I chose an &lt;a href=&quot;http://www.ebay.ca/itm/FT232RL-3-3V-5-5V-FTDI-USB-to-TTL-Serial-Adapter-Module-for-Arduino-Mini-Port-/162385456286?hash=item25ceed6c9e:g:g8cAAOSwNnRYl~eJ&quot; class=&quot;css-1i9b1eb&quot;&gt;FTDI FT232RL-based board&lt;/a&gt; that I found listed on eBay for a few dollars. &lt;/p&gt;&lt;h3 class=&quot;css-3omw84&quot;&gt;HAP bridge&lt;/h3&gt;&lt;p class=&quot;css-ocxwk4&quot;&gt;For the bridge, we have the following basic requirements:&lt;/p&gt;&lt;ul class=&quot;css-aq9zkf&quot;&gt;&lt;li class=&quot;css-0&quot;&gt;Capable of BLE communication&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;Capable of Wi-Fi communication&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;Capable of running the node.js-based bridge server software&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;Low power requirements (preferably)&lt;/li&gt;&lt;/ul&gt;&lt;p class=&quot;css-ocxwk4&quot;&gt;Our computational resource requirements are very low, since the bridge will only serve to periodically relay readings from the sensor to HomeKit devices. This leaves us with many options, including most modern laptops and low-cost single-board computers like the Raspberry Pi. The operating system does not matter much, as long as it&amp;#x27;s capable of running node.js.&lt;/p&gt;&lt;p class=&quot;css-ocxwk4&quot;&gt;My choice for this module was a &lt;a href=&quot;https://getchip.com/pages/chip&quot; class=&quot;css-1i9b1eb&quot;&gt;C.H.I.P. Computer&lt;/a&gt; that I have lying around and that I&amp;#x27;ve been waiting to put to good use.&lt;/p&gt;&lt;h2 class=&quot;css-992wu8&quot;&gt;Hardware assembly&lt;/h2&gt;&lt;p class=&quot;css-ocxwk4&quot;&gt;Having discussed all the major hardware components to be used for the sensor, let&amp;#x27;s dive into assembling it!&lt;/p&gt;&lt;h3 class=&quot;css-3omw84&quot;&gt;Parts list&lt;/h3&gt;&lt;p class=&quot;css-ocxwk4&quot;&gt;&lt;em class=&quot;css-0&quot;&gt;These parts are available from different suppliers; I suggest googling the model number to see which suppliers are available and which is best for you.&lt;/em&gt;&lt;/p&gt;&lt;ol class=&quot;css-aq9zkf&quot;&gt;&lt;li class=&quot;css-0&quot;&gt;WRL-13990&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;DHT-22&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;Breadboard (small, I used 30 columns by A-J rows)&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;Jumper wires, male-male × 3&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;Jumper wires, female-female × 6&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;FTDI FT232RL-based USB-to-serial board and mini-USB-to-USB cable&lt;/li&gt;&lt;/ol&gt;&lt;h3 class=&quot;css-3omw84&quot;&gt;Diagram&lt;/h3&gt;&lt;div src=&quot;sensor_diagram.png&quot; class=&quot;css-0&quot;&gt;&lt;/div&gt;&lt;h3 class=&quot;css-3omw84&quot;&gt;Assembly instructions&lt;/h3&gt;&lt;ol class=&quot;css-aq9zkf&quot;&gt;&lt;li class=&quot;css-0&quot;&gt;Complete the procedure described in the &lt;a href=&quot;https://learn.sparkfun.com/tutorials/nrf52832-breakout-board-hookup-guide&quot; class=&quot;css-1i9b1eb&quot;&gt;WRL-13990 Hookup Guide&lt;/a&gt; (most importantly, solder the headers onto the WRL-13990).&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;Insert the WRL-13990 into the breadboard as shown in the diagram.&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;Insert the DHT-22 into the breadboard as shown in the diagram.&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;Connect the DHT-22 to the WRL-13990 using 3 male-to-male jumper wires, as shown in the diagram.&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;Connect the WRL-13990 to the USB-to-serial chip using the 6 female-to-female jumper wires, as explained in the Hookup Guide from step 1.&lt;/li&gt;&lt;/ol&gt;&lt;h3 class=&quot;css-3omw84&quot;&gt;Photos&lt;/h3&gt;&lt;p class=&quot;css-ocxwk4&quot;&gt;Once assembled, our sensor (with attached USB-to-serial programmer) looks like this:
&lt;span class=&quot;gatsby-resp-image-wrapper&quot; style=&quot;position:relative;display:block;margin-left:auto;margin-right:auto;max-width:960px&quot;&gt;
      &lt;span class=&quot;gatsby-resp-image-background-image&quot; style=&quot;padding-bottom:75%;position:relative;bottom:0;left:0;background-image:url(&amp;#x27;data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAPABQDASIAAhEBAxEB/8QAFwAAAwEAAAAAAAAAAAAAAAAAAAQFAf/EABUBAQEAAAAAAAAAAAAAAAAAAAAB/9oADAMBAAIQAxAAAAFByY/LMND/xAAaEAEBAAMBAQAAAAAAAAAAAAABAgAEEQMS/9oACAEBAAEFAvOBb13icZtnHaMqvqv/xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/AT//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/AT//xAAbEAACAQUAAAAAAAAAAAAAAAAAARECEDNRof/aAAgBAQAGPwJLZCpRFsfRs//EABsQAAIDAAMAAAAAAAAAAAAAAAABESExQVGR/9oACAEBAAE/IdAOxeI+5HvbU4GGj3D0VDEs/9oADAMBAAIAAwAAABAkL//EABYRAQEBAAAAAAAAAAAAAAAAAAEAIf/aAAgBAwEBPxASy//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8QP//EABwQAQEAAgIDAAAAAAAAAAAAAAERACExQVFhcf/aAAgBAQABPxCcg2ywMG101rny84Z8cg8mSwiOzEVvebl2ITDr1n//2Q==&amp;#x27;);background-size:cover;display:block&quot;&gt;&lt;/span&gt;
  &lt;img class=&quot;gatsby-resp-image-image css-0&quot; alt=&quot;sensor photo 1&quot; title=&quot;sensor photo 1&quot; src=&quot;/static/781ecc2c23fd3c2d2ce085e273db1c95/18e3b/sensor_photo_1.jpg&quot; srcSet=&quot;/static/781ecc2c23fd3c2d2ce085e273db1c95/46946/sensor_photo_1.jpg 240w,/static/781ecc2c23fd3c2d2ce085e273db1c95/55489/sensor_photo_1.jpg 480w,/static/781ecc2c23fd3c2d2ce085e273db1c95/18e3b/sensor_photo_1.jpg 960w,/static/781ecc2c23fd3c2d2ce085e273db1c95/60e21/sensor_photo_1.jpg 1440w,/static/781ecc2c23fd3c2d2ce085e273db1c95/69b48/sensor_photo_1.jpg 1920w,/static/781ecc2c23fd3c2d2ce085e273db1c95/714ef/sensor_photo_1.jpg 3264w&quot; sizes=&quot;(max-width: 960px) 100vw, 960px&quot; style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0&quot; loading=&quot;lazy&quot;/&gt;
    &lt;/span&gt;
&lt;span class=&quot;gatsby-resp-image-wrapper&quot; style=&quot;position:relative;display:block;margin-left:auto;margin-right:auto;max-width:960px&quot;&gt;
      &lt;span class=&quot;gatsby-resp-image-background-image&quot; style=&quot;padding-bottom:75%;position:relative;bottom:0;left:0;background-image:url(&amp;#x27;data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAPABQDASIAAhEBAxEB/8QAFwAAAwEAAAAAAAAAAAAAAAAAAAMEAv/EABQBAQAAAAAAAAAAAAAAAAAAAAH/2gAMAwEAAhADEAAAAZ1IpGE0J//EABsQAAIDAAMAAAAAAAAAAAAAAAECAwQSABEh/9oACAEBAAEFAo64K2I0RyCOLnOR03p//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPwE//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPwE//8QAHhAAAQMEAwAAAAAAAAAAAAAAAAEhMRARMkFRkaH/2gAIAQEABj8CSOyycaGIcx9p/8QAGxABAAMAAwEAAAAAAAAAAAAAAQARITFRYXH/2gAIAQEAAT8hUnb3Ae5KNxyhp0jyV7mN19i1rP/aAAwDAQACAAMAAAAQd8//xAAVEQEBAAAAAAAAAAAAAAAAAAABEP/aAAgBAwEBPxBn/8QAFREBAQAAAAAAAAAAAAAAAAAAECH/2gAIAQIBAT8Qp//EAB0QAQEAAgIDAQAAAAAAAAAAAAERACFhkTFBcbH/2gAIAQEAAT8Qd6Mb4LwOLjuAHb9xMElQZTGXfpeusZWwcHWVFr+Z/9k=&amp;#x27;);background-size:cover;display:block&quot;&gt;&lt;/span&gt;
  &lt;img class=&quot;gatsby-resp-image-image css-0&quot; alt=&quot;sensor photo 2&quot; title=&quot;sensor photo 2&quot; src=&quot;/static/19a6b71dff8a49c38ddbbd1eae7e7485/18e3b/sensor_photo_2.jpg&quot; srcSet=&quot;/static/19a6b71dff8a49c38ddbbd1eae7e7485/46946/sensor_photo_2.jpg 240w,/static/19a6b71dff8a49c38ddbbd1eae7e7485/55489/sensor_photo_2.jpg 480w,/static/19a6b71dff8a49c38ddbbd1eae7e7485/18e3b/sensor_photo_2.jpg 960w,/static/19a6b71dff8a49c38ddbbd1eae7e7485/60e21/sensor_photo_2.jpg 1440w,/static/19a6b71dff8a49c38ddbbd1eae7e7485/69b48/sensor_photo_2.jpg 1920w,/static/19a6b71dff8a49c38ddbbd1eae7e7485/714ef/sensor_photo_2.jpg 3264w&quot; sizes=&quot;(max-width: 960px) 100vw, 960px&quot; style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0&quot; loading=&quot;lazy&quot;/&gt;
    &lt;/span&gt;&lt;/p&gt;&lt;h2 class=&quot;css-992wu8&quot;&gt;Software architecture and data flow&lt;/h2&gt;&lt;p class=&quot;css-ocxwk4&quot;&gt;Now that we&amp;#x27;ve assembled the sensor, we need to program it. In the next post, we&amp;#x27;ll look at the sensor&amp;#x27;s software in detail. Here, let&amp;#x27;s look at the required software functionality from a high level.&lt;/p&gt;&lt;p class=&quot;css-ocxwk4&quot;&gt;The basic data flow is as follows:&lt;/p&gt;&lt;ol class=&quot;css-aq9zkf&quot;&gt;&lt;li class=&quot;css-0&quot;&gt;The sensor periodically broadcasts its readings over BLE. &lt;em class=&quot;css-0&quot;&gt;(sensor module)&lt;/em&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;The HAP bridge listens for the sensor&amp;#x27;s BLE broadcasts, repeatedly storing the last received value. &lt;em class=&quot;css-0&quot;&gt;(bridge module)&lt;/em&gt;&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;After receiving a new BLE broadcast, the HAP bridge broadcasts the new sensor reading value over HAP via Wi-Fi to paired HAP devices. &lt;em class=&quot;css-0&quot;&gt;(bridge module)&lt;/em&gt;&lt;/li&gt;&lt;/ol&gt;&lt;h3 class=&quot;css-3omw84&quot;&gt;Sensor module&lt;/h3&gt;&lt;p class=&quot;css-ocxwk4&quot;&gt;As discussed in the previous post, I aimed to keep the sensor&amp;#x27;s role as simple as possible in order to achieve low power consumption (and thus long battery life). The &amp;quot;dumb&amp;quot; sensor&amp;#x27;s only task is to indefinitely broadcast sensor readings out over BLE; all HAP functionality is offloaded to the bridge.&lt;/p&gt;&lt;p class=&quot;css-ocxwk4&quot;&gt;The sensor module will utilize &lt;a href=&quot;https://www.nordicsemi.com/eng/Products/Bluetooth-low-energy/nRF5-SDK&quot; class=&quot;css-1i9b1eb&quot;&gt;Nordic&amp;#x27;s nRF5 SDK&lt;/a&gt; to interface with the SoC hardware. It will also be necessary to interface with the DHT-22 in order to read measurements from it.&lt;/p&gt;&lt;h3 class=&quot;css-3omw84&quot;&gt;Bridge module&lt;/h3&gt;&lt;p class=&quot;css-ocxwk4&quot;&gt;As explained in the previous post, the bridge will use &lt;a href=&quot;https://github.com/KhaosT/HAP-NodeJS&quot; class=&quot;css-1i9b1eb&quot;&gt;HAP-NodeJS&lt;/a&gt; to abstract away the details of HAP communication, including device pairing and sensor value communication. The bridge will also utilize a node.js BLE library in order to receive BLE communications from the sensor.&lt;/p&gt;&lt;h3 class=&quot;css-3omw84&quot;&gt;Diagram&lt;/h3&gt;&lt;p class=&quot;css-ocxwk4&quot;&gt;Here&amp;#x27;s a block diagram showing our software architecture. Our custom-written modules are shown in white, while third party modules are shaded.&lt;/p&gt;&lt;img src=&quot;static/software-arch-a40a6e93a416646e4e00472699ed2b1e.svg&quot; class=&quot;css-0&quot;/&gt;&lt;h2 class=&quot;css-992wu8&quot;&gt;Conclusion and next steps&lt;/h2&gt;&lt;p class=&quot;css-ocxwk4&quot;&gt;Now that we&amp;#x27;ve looked at hardware assembly and high-level data flow, we&amp;#x27;re ready to get into the software implementation details. In the next post, we&amp;#x27;ll look at the software code necessary to make our sensor work.&lt;/p&gt;&lt;style data-emotion-css=&quot;m4uvnn&quot;&gt;.css-m4uvnn{font-family:inherit;font-weight:500;line-height:1.25;margin:0;margin-bottom:0.25rem;font-size:1rem;color:var(--theme-ui-colors-heading,#000);margin-top:1rem;}@media screen and (min-width:640px){.css-m4uvnn{font-size:1.1rem;}}@media screen and (min-width:768px){.css-m4uvnn{font-size:1.1rem;}}@media screen and (min-width:1024px){.css-m4uvnn{font-size:1.3rem;}}&lt;/style&gt;&lt;h5 class=&quot;css-m4uvnn&quot;&gt;On to &lt;a href=&quot;/blog/ble-homekit-sensor-pt3&quot; class=&quot;css-1i9b1eb&quot;&gt;Part 3&lt;/a&gt;!&lt;/h5&gt;</content:encoded></item><item><title><![CDATA[Building a battery-powered wireless sensor using Bluetooth Low-Energy (BLE) and Apple HomeKit (Part 1)]]></title><link>https://dgross.ca/blog/ble-homekit-sensor-pt1</link><guid isPermaLink="false">https://dgross.ca/blog/ble-homekit-sensor-pt1</guid><pubDate>Thu, 25 May 2017 04:00:00 GMT</pubDate><content:encoded>&lt;style data-emotion-css=&quot;9096aj&quot;&gt;body{--theme-ui-colors-transparent:var(--theme-ui-colors-transparent,transparent);--theme-ui-colors-black:var(--theme-ui-colors-black,#000);--theme-ui-colors-white:var(--theme-ui-colors-white,#fff);--theme-ui-colors-gray-0:var(--theme-ui-colors-gray-0,null);--theme-ui-colors-gray-1:var(--theme-ui-colors-gray-1,#f7fafc);--theme-ui-colors-gray-2:var(--theme-ui-colors-gray-2,#edf2f7);--theme-ui-colors-gray-3:var(--theme-ui-colors-gray-3,#e2e8f0);--theme-ui-colors-gray-4:var(--theme-ui-colors-gray-4,#cbd5e0);--theme-ui-colors-gray-5:var(--theme-ui-colors-gray-5,#a0aec0);--theme-ui-colors-gray-6:var(--theme-ui-colors-gray-6,#718096);--theme-ui-colors-gray-7:var(--theme-ui-colors-gray-7,#4a5568);--theme-ui-colors-gray-8:var(--theme-ui-colors-gray-8,#2d3748);--theme-ui-colors-gray-9:var(--theme-ui-colors-gray-9,#1a202c);--theme-ui-colors-red-0:var(--theme-ui-colors-red-0,null);--theme-ui-colors-red-1:var(--theme-ui-colors-red-1,#fff5f5);--theme-ui-colors-red-2:var(--theme-ui-colors-red-2,#fed7d7);--theme-ui-colors-red-3:var(--theme-ui-colors-red-3,#feb2b2);--theme-ui-colors-red-4:var(--theme-ui-colors-red-4,#fc8181);--theme-ui-colors-red-5:var(--theme-ui-colors-red-5,#f56565);--theme-ui-colors-red-6:var(--theme-ui-colors-red-6,#e53e3e);--theme-ui-colors-red-7:var(--theme-ui-colors-red-7,#c53030);--theme-ui-colors-red-8:var(--theme-ui-colors-red-8,#9b2c2c);--theme-ui-colors-red-9:var(--theme-ui-colors-red-9,#742a2a);--theme-ui-colors-orange-0:var(--theme-ui-colors-orange-0,null);--theme-ui-colors-orange-1:var(--theme-ui-colors-orange-1,#fffaf0);--theme-ui-colors-orange-2:var(--theme-ui-colors-orange-2,#feebc8);--theme-ui-colors-orange-3:var(--theme-ui-colors-orange-3,#fbd38d);--theme-ui-colors-orange-4:var(--theme-ui-colors-orange-4,#f6ad55);--theme-ui-colors-orange-5:var(--theme-ui-colors-orange-5,#ed8936);--theme-ui-colors-orange-6:var(--theme-ui-colors-orange-6,#dd6b20);--theme-ui-colors-orange-7:var(--theme-ui-colors-orange-7,#c05621);--theme-ui-colors-orange-8:var(--theme-ui-colors-orange-8,#9c4221);--theme-ui-colors-orange-9:var(--theme-ui-colors-orange-9,#7b341e);--theme-ui-colors-yellow-0:var(--theme-ui-colors-yellow-0,null);--theme-ui-colors-yellow-1:var(--theme-ui-colors-yellow-1,#fffff0);--theme-ui-colors-yellow-2:var(--theme-ui-colors-yellow-2,#fefcbf);--theme-ui-colors-yellow-3:var(--theme-ui-colors-yellow-3,#faf089);--theme-ui-colors-yellow-4:var(--theme-ui-colors-yellow-4,#f6e05e);--theme-ui-colors-yellow-5:var(--theme-ui-colors-yellow-5,#ecc94b);--theme-ui-colors-yellow-6:var(--theme-ui-colors-yellow-6,#d69e2e);--theme-ui-colors-yellow-7:var(--theme-ui-colors-yellow-7,#b7791f);--theme-ui-colors-yellow-8:var(--theme-ui-colors-yellow-8,#975a16);--theme-ui-colors-yellow-9:var(--theme-ui-colors-yellow-9,#744210);--theme-ui-colors-green-0:var(--theme-ui-colors-green-0,null);--theme-ui-colors-green-1:var(--theme-ui-colors-green-1,#f0fff4);--theme-ui-colors-green-2:var(--theme-ui-colors-green-2,#c6f6d5);--theme-ui-colors-green-3:var(--theme-ui-colors-green-3,#9ae6b4);--theme-ui-colors-green-4:var(--theme-ui-colors-green-4,#68d391);--theme-ui-colors-green-5:var(--theme-ui-colors-green-5,#48bb78);--theme-ui-colors-green-6:var(--theme-ui-colors-green-6,#38a169);--theme-ui-colors-green-7:var(--theme-ui-colors-green-7,#2f855a);--theme-ui-colors-green-8:var(--theme-ui-colors-green-8,#276749);--theme-ui-colors-green-9:var(--theme-ui-colors-green-9,#22543d);--theme-ui-colors-teal-0:var(--theme-ui-colors-teal-0,null);--theme-ui-colors-teal-1:var(--theme-ui-colors-teal-1,#e6fffa);--theme-ui-colors-teal-2:var(--theme-ui-colors-teal-2,#b2f5ea);--theme-ui-colors-teal-3:var(--theme-ui-colors-teal-3,#81e6d9);--theme-ui-colors-teal-4:var(--theme-ui-colors-teal-4,#4fd1c5);--theme-ui-colors-teal-5:var(--theme-ui-colors-teal-5,#38b2ac);--theme-ui-colors-teal-6:var(--theme-ui-colors-teal-6,#319795);--theme-ui-colors-teal-7:var(--theme-ui-colors-teal-7,#2c7a7b);--theme-ui-colors-teal-8:var(--theme-ui-colors-teal-8,#285e61);--theme-ui-colors-teal-9:var(--theme-ui-colors-teal-9,#234e52);--theme-ui-colors-blue-0:var(--theme-ui-colors-blue-0,null);--theme-ui-colors-blue-1:var(--theme-ui-colors-blue-1,#ebf8ff);--theme-ui-colors-blue-2:var(--theme-ui-colors-blue-2,#bee3f8);--theme-ui-colors-blue-3:var(--theme-ui-colors-blue-3,#90cdf4);--theme-ui-colors-blue-4:var(--theme-ui-colors-blue-4,#63b3ed);--theme-ui-colors-blue-5:var(--theme-ui-colors-blue-5,#4299e1);--theme-ui-colors-blue-6:var(--theme-ui-colors-blue-6,#3182ce);--theme-ui-colors-blue-7:var(--theme-ui-colors-blue-7,#2b6cb0);--theme-ui-colors-blue-8:var(--theme-ui-colors-blue-8,#2c5282);--theme-ui-colors-blue-9:var(--theme-ui-colors-blue-9,#2a4365);--theme-ui-colors-indigo-0:var(--theme-ui-colors-indigo-0,null);--theme-ui-colors-indigo-1:var(--theme-ui-colors-indigo-1,#ebf4ff);--theme-ui-colors-indigo-2:var(--theme-ui-colors-indigo-2,#c3dafe);--theme-ui-colors-indigo-3:var(--theme-ui-colors-indigo-3,#a3bffa);--theme-ui-colors-indigo-4:var(--theme-ui-colors-indigo-4,#7f9cf5);--theme-ui-colors-indigo-5:var(--theme-ui-colors-indigo-5,#667eea);--theme-ui-colors-indigo-6:var(--theme-ui-colors-indigo-6,#5a67d8);--theme-ui-colors-indigo-7:var(--theme-ui-colors-indigo-7,#4c51bf);--theme-ui-colors-indigo-8:var(--theme-ui-colors-indigo-8,#434190);--theme-ui-colors-indigo-9:var(--theme-ui-colors-indigo-9,#3c366b);--theme-ui-colors-purple-0:var(--theme-ui-colors-purple-0,null);--theme-ui-colors-purple-1:var(--theme-ui-colors-purple-1,#faf5ff);--theme-ui-colors-purple-2:var(--theme-ui-colors-purple-2,#e9d8fd);--theme-ui-colors-purple-3:var(--theme-ui-colors-purple-3,#d6bcfa);--theme-ui-colors-purple-4:var(--theme-ui-colors-purple-4,#b794f4);--theme-ui-colors-purple-5:var(--theme-ui-colors-purple-5,#9f7aea);--theme-ui-colors-purple-6:var(--theme-ui-colors-purple-6,#805ad5);--theme-ui-colors-purple-7:var(--theme-ui-colors-purple-7,#6b46c1);--theme-ui-colors-purple-8:var(--theme-ui-colors-purple-8,#553c9a);--theme-ui-colors-purple-9:var(--theme-ui-colors-purple-9,#44337a);--theme-ui-colors-pink-0:var(--theme-ui-colors-pink-0,null);--theme-ui-colors-pink-1:var(--theme-ui-colors-pink-1,#fff5f7);--theme-ui-colors-pink-2:var(--theme-ui-colors-pink-2,#fed7e2);--theme-ui-colors-pink-3:var(--theme-ui-colors-pink-3,#fbb6ce);--theme-ui-colors-pink-4:var(--theme-ui-colors-pink-4,#f687b3);--theme-ui-colors-pink-5:var(--theme-ui-colors-pink-5,#ed64a6);--theme-ui-colors-pink-6:var(--theme-ui-colors-pink-6,#d53f8c);--theme-ui-colors-pink-7:var(--theme-ui-colors-pink-7,#b83280);--theme-ui-colors-pink-8:var(--theme-ui-colors-pink-8,#97266d);--theme-ui-colors-pink-9:var(--theme-ui-colors-pink-9,#702459);--theme-ui-colors-grayDark:var(--theme-ui-colors-grayDark,#2d3748);--theme-ui-colors-text:var(--theme-ui-colors-text,#2d3748);--theme-ui-colors-background:var(--theme-ui-colors-background,#fff);--theme-ui-colors-primary:var(--theme-ui-colors-primary,#2b6cb0);--theme-ui-colors-primaryHover:var(--theme-ui-colors-primaryHover,#2c5282);--theme-ui-colors-secondary:var(--theme-ui-colors-secondary,#718096);--theme-ui-colors-muted:var(--theme-ui-colors-muted,#e2e8f0);--theme-ui-colors-success:var(--theme-ui-colors-success,#9ae6b4);--theme-ui-colors-info:var(--theme-ui-colors-info,#63b3ed);--theme-ui-colors-warning:var(--theme-ui-colors-warning,#faf089);--theme-ui-colors-danger:var(--theme-ui-colors-danger,#feb2b2);--theme-ui-colors-light:var(--theme-ui-colors-light,#f7fafc);--theme-ui-colors-dark:var(--theme-ui-colors-dark,#2d3748);--theme-ui-colors-textMuted:var(--theme-ui-colors-textMuted,#718096);--theme-ui-colors-toggleIcon:var(--theme-ui-colors-toggleIcon,#2d3748);--theme-ui-colors-heading:var(--theme-ui-colors-heading,#000);--theme-ui-colors-divide:var(--theme-ui-colors-divide,#cbd5e0);color:var(--theme-ui-colors-text,#2d3748);background-color:var(--theme-ui-colors-background,#fff);}body.theme-ui-dark{--theme-ui-colors-text:var(--theme-ui-colors-modes-dark-text,#cbd5e0);--theme-ui-colors-primary:var(--theme-ui-colors-modes-dark-primary,#63b3ed);--theme-ui-colors-secondary:var(--theme-ui-colors-modes-dark-secondary,#7f8ea3);--theme-ui-colors-toggleIcon:var(--theme-ui-colors-modes-dark-toggleIcon,#cbd5e0);--theme-ui-colors-background:var(--theme-ui-colors-modes-dark-background,#1A202C);--theme-ui-colors-heading:var(--theme-ui-colors-modes-dark-heading,#fff);--theme-ui-colors-divide:var(--theme-ui-colors-modes-dark-divide,#2d3748);--theme-ui-colors-muted:var(--theme-ui-colors-modes-dark-muted,#2d3748);}&lt;/style&gt;&lt;style data-emotion-css=&quot;tm2q0o&quot;&gt;*{box-sizing:border-box;}body{margin:0;font-family:&quot;IBM Plex Sans&quot;,-apple-system,BlinkMacSystemFont,&quot;Segoe UI&quot;,Roboto,&quot;Helvetica Neue&quot;,Arial,&quot;Noto Sans&quot;,sans-serif,&quot;Apple Color Emoji&quot;,&quot;Segoe UI Emoji&quot;,&quot;Segoe UI Symbol&quot;,&quot;Noto Color Emoji&quot;;line-height:1.625;font-weight:400;color:var(--theme-ui-colors-text,#2d3748);background-color:var(--theme-ui-colors-background,#fff);padding:0;box-sizing:border-box;text-rendering:optimizeLegibility;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;}&lt;/style&gt;&lt;style data-emotion-css=&quot;ocxwk4&quot;&gt;.css-ocxwk4{font-size:1rem;-webkit-letter-spacing:-0.003em;-moz-letter-spacing:-0.003em;-ms-letter-spacing:-0.003em;letter-spacing:-0.003em;line-height:1.625;--baseline-multiplier:0.179;--x-height-multiplier:0.35;word-break:break-word;}@media screen and (min-width:640px){.css-ocxwk4{font-size:1rem;}}@media screen and (min-width:768px){.css-ocxwk4{font-size:1.1rem;}}&lt;/style&gt;&lt;p class=&quot;css-ocxwk4&quot;&gt;In this series, we&amp;#x27;ll look at building a simple wireless temperature and humidity sensor using inexpensive components and Bluetooth Low Energy (BLE) for communication. We&amp;#x27;ll read off the sensor values using the Home app from an iOS device.&lt;/p&gt;&lt;style data-emotion-css=&quot;992wu8&quot;&gt;.css-992wu8{font-family:inherit;font-weight:500;line-height:1.25;margin:0;margin-bottom:0.25rem;font-size:1.6rem;margin-top:2rem;color:var(--theme-ui-colors-heading,#000);}@media screen and (min-width:640px){.css-992wu8{font-size:1.8rem;}}@media screen and (min-width:768px){.css-992wu8{font-size:1.8rem;}}@media screen and (min-width:1024px){.css-992wu8{font-size:2rem;}}&lt;/style&gt;&lt;h2 class=&quot;css-992wu8&quot;&gt;Motivation&lt;/h2&gt;&lt;p class=&quot;css-ocxwk4&quot;&gt;This project originally started when I got a new humidifier at home and wanted an easy way to tell when the humidity levels were too low. After searching in vain for an inexpensive HomeKit-compatible sensor, I decided to see if I could build one myself from cheap components.&lt;/p&gt;&lt;p class=&quot;css-ocxwk4&quot;&gt;I wanted my sensor to:&lt;/p&gt;&lt;style data-emotion-css=&quot;aq9zkf&quot;&gt;.css-aq9zkf li{font-size:1rem;-webkit-letter-spacing:-0.003em;-moz-letter-spacing:-0.003em;-ms-letter-spacing:-0.003em;letter-spacing:-0.003em;line-height:1.625;--baseline-multiplier:0.179;--x-height-multiplier:0.35;}@media screen and (min-width:640px){.css-aq9zkf li{font-size:1rem;}}@media screen and (min-width:768px){.css-aq9zkf li{font-size:1.1rem;}}&lt;/style&gt;&lt;ul class=&quot;css-aq9zkf&quot;&gt;&lt;li class=&quot;css-0&quot;&gt;Have a low cost to build&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;Have low power consumption, be capable of running from a few AA batteries for ~1 year (or at least a few months)&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;Transmit sensor values that could be easily viewed from my smartphone&lt;/li&gt;&lt;/ul&gt;&lt;p class=&quot;css-ocxwk4&quot;&gt;After some brief research, I chose &lt;strong class=&quot;css-0&quot;&gt;Bluetooth Low Energy (BLE)&lt;/strong&gt; and &lt;strong class=&quot;css-0&quot;&gt;Apple HomeKit&lt;/strong&gt; as the 2 basic implementation technologies for this project.&lt;/p&gt;&lt;style data-emotion-css=&quot;3omw84&quot;&gt;.css-3omw84{font-family:inherit;font-weight:500;line-height:1.25;margin:0;margin-bottom:0.25rem;font-size:1.3rem;margin-top:2rem;color:var(--theme-ui-colors-heading,#000);}@media screen and (min-width:640px){.css-3omw84{font-size:1.6rem;}}@media screen and (min-width:768px){.css-3omw84{font-size:1.6rem;}}@media screen and (min-width:1024px){.css-3omw84{font-size:1.8rem;}}&lt;/style&gt;&lt;h3 class=&quot;css-3omw84&quot;&gt;Why HomeKit?&lt;/h3&gt;&lt;p class=&quot;css-ocxwk4&quot;&gt;&lt;style data-emotion-css=&quot;1i9b1eb&quot;&gt;.css-1i9b1eb{color:var(--theme-ui-colors-primary,#2b6cb0);-webkit-text-decoration:none;text-decoration:none;}.css-1i9b1eb:hover{-webkit-text-decoration:underline;text-decoration:underline;}&lt;/style&gt;&lt;a href=&quot;https://developer.apple.com/homekit/&quot; class=&quot;css-1i9b1eb&quot;&gt;HomeKit&lt;/a&gt; is a relatively new (2014) framework developed by Apple to enable advanced, centralized home-automation control with tight integration inside the iOS ecosystem. HomeKit is making it easy for ordinary, non-technical people to set up elaborate home automation schemes, with an intuitive control interface (the iOS Home app), preset device state collections called &amp;quot;scenes&amp;quot;, and voice control (via Siri).&lt;/p&gt;&lt;p class=&quot;css-ocxwk4&quot;&gt;Some people might be surprised to learn that home automation has actually been around for decades, and there have been &lt;a href=&quot;https://en.wikipedia.org/wiki/X10_%28industry_standard%29&quot; class=&quot;css-1i9b1eb&quot;&gt;comprehensive wireless control system&lt;/a&gt;s since the mid-1970s. There is an entire market of controllers, switches and &amp;quot;smart&amp;quot; (dumb by today&amp;#x27;s standards) devices that existed long before HomeKit or even the first iPhone.&lt;/p&gt;&lt;p class=&quot;css-ocxwk4&quot;&gt;So why does it seem that only now are we starting to hear about the smart home revolution? I think it&amp;#x27;s for the same reason that it wasn&amp;#x27;t until the mid-1980s that we didn&amp;#x27;t hear about the personal computer revolution. Like it has with many technologies before, Apple is bringing smart home device technology out of the realm of engineers, academics, and basement-dwelling geeks and into the hands of ordinary non-technical folk. Apple has a knack for making complex technical systems accessible through simple, intuitive interfaces. With this combination of user-friendliness and tight Apple ecosystem integration (e.g. &amp;quot;Siri, turn on the light&amp;quot;), I think HomeKit is poised to bring home automation into the mainstream at greater proportions than ever before.&lt;/p&gt;&lt;p class=&quot;css-ocxwk4&quot;&gt;Considering all that, HomeKit is a technology that I was eager to start playing with and learning about.&lt;/p&gt;&lt;h3 class=&quot;css-3omw84&quot;&gt;Why Bluetooth Low Energy?&lt;/h3&gt;&lt;p class=&quot;css-ocxwk4&quot;&gt;Bluetooth Low Energy (BLE) is an open wireless data transmission standard that was introduced by Nokia in the late 2000s, offering near-range communication at low throughput rates (~0.3Mbit/s), with very low power requirements (in the 0.01 - 0.5W range). &lt;/p&gt;&lt;p class=&quot;css-ocxwk4&quot;&gt;Since the introduction of the BLE standard, the market has seen a flood of new BLE-compatible devices. The inclusion of BLE in smartphones, notably the iPhone (since the 4S model), has encouraged wireless peripheral manufacturers to utilize BLE, and this in turn has induced further proliferation of BLE-capable hub devices. A &lt;a href=&quot;https://www.abiresearch.com/press/bluetooth-low-energy-devices-account-27-total-blue/&quot; class=&quot;css-1i9b1eb&quot;&gt;report by ABI Research&lt;/a&gt; forecasts growth of Bluetooth Low Energy device production by 34% between 2016 and 2021, with BLE devices comprising 27% of total Bluetooth shipments by 2021.&lt;/p&gt;&lt;p class=&quot;css-ocxwk4&quot;&gt;BLE&amp;#x27;s power characteristics make it an excellent candidate technology for data transmission in this project. Although there are other technologies we could have used here instead, for example &lt;a href=&quot;https://en.wikipedia.org/wiki/Zigbee&quot; class=&quot;css-1i9b1eb&quot;&gt;ZigBee&lt;/a&gt; or &lt;a href=&quot;https://en.wikipedia.org/wiki/ANT_(network)&quot; class=&quot;css-1i9b1eb&quot;&gt;ANT&lt;/a&gt;, I was most interested to get to know the mechanics of BLE because of its prevalence in the marketplace and its expected growth in the years to come.&lt;/p&gt;&lt;h2 class=&quot;css-992wu8&quot;&gt;Solutions&lt;/h2&gt;&lt;p class=&quot;css-ocxwk4&quot;&gt;HomeKit is a closed, proprietary protocol developed solely by Apple. Its specifications are only available to Apple MFi program members. I&amp;#x27;m not an MFi program member and don&amp;#x27;t have access to those specifications, so we won&amp;#x27;t go into much detail here about the HomeKit protocol.&lt;/p&gt;&lt;p class=&quot;css-ocxwk4&quot;&gt;HomeKit fundamentally operates over 2 network protocols: &lt;/p&gt;&lt;ol class=&quot;css-aq9zkf&quot;&gt;&lt;li class=&quot;css-0&quot;&gt;IP (over a wired or wireless LAN)&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;Bluetooth Low Energy (BLE)&lt;/li&gt;&lt;/ol&gt;&lt;p class=&quot;css-ocxwk4&quot;&gt;The de-facto standard software implementation of HomeKit Accessory Protocol (HAP) is the closed-source OberonHAP software developed by &lt;a href=&quot;https://oberonhap.com/products/&quot; class=&quot;css-1i9b1eb&quot;&gt;Oberon&lt;/a&gt;. Although I haven&amp;#x27;t worked with it myself, according to Oberon it is the best implementation available, performing a few times faster and consuming less memory than any alternative implementation.&lt;/p&gt;&lt;p class=&quot;css-ocxwk4&quot;&gt;Luckily, for hobbyists like myself, there are a number of reasonably high-quality open-source HAP implementations. I&amp;#x27;ve listed some of them below:&lt;/p&gt;&lt;style data-emotion-css=&quot;f4lqjx&quot;&gt;.css-f4lqjx{width:100%;margin-top:2rem;margin-bottom:2rem;border-collapse:separate;border-spacing:0;}.css-f4lqjx th,.css-f4lqjx td{text-align:left;padding-top:4px;padding-bottom:4px;padding-right:4px;padding-left:0;border-color:var(--theme-ui-colors-muted,#e2e8f0);border-bottom-style:solid;}&lt;/style&gt;&lt;table class=&quot;css-f4lqjx&quot;&gt;&lt;thead&gt;&lt;tr class=&quot;css-0&quot;&gt;&lt;style data-emotion-css=&quot;18ma8h6&quot;&gt;.css-18ma8h6{vertical-align:bottom;border-bottom-width:2px;color:var(--theme-ui-colors-heading,#000);}&lt;/style&gt;&lt;th class=&quot;css-18ma8h6&quot;&gt;Project&lt;/th&gt;&lt;th class=&quot;css-18ma8h6&quot;&gt;Network type&lt;/th&gt;&lt;th class=&quot;css-18ma8h6&quot;&gt;Language&lt;/th&gt;&lt;/tr&gt;&lt;/thead&gt;&lt;tbody&gt;&lt;tr class=&quot;css-0&quot;&gt;&lt;style data-emotion-css=&quot;15msde0&quot;&gt;.css-15msde0{vertical-align:top;border-bottom-width:1px;}&lt;/style&gt;&lt;td class=&quot;css-15msde0&quot;&gt;&lt;a href=&quot;https://github.com/KhaosT/HAP-NodeJS&quot; class=&quot;css-1i9b1eb&quot;&gt;KhaosT/HAP-NodeJS&lt;/a&gt;&lt;/td&gt;&lt;td class=&quot;css-15msde0&quot;&gt;IP&lt;/td&gt;&lt;td class=&quot;css-15msde0&quot;&gt;Javascript (node.js)&lt;/td&gt;&lt;/tr&gt;&lt;tr class=&quot;css-0&quot;&gt;&lt;td class=&quot;css-15msde0&quot;&gt;&lt;a href=&quot;https://github.com/brutella/hc&quot; class=&quot;css-1i9b1eb&quot;&gt;brutella/hc&lt;/a&gt;&lt;/td&gt;&lt;td class=&quot;css-15msde0&quot;&gt;IP&lt;/td&gt;&lt;td class=&quot;css-15msde0&quot;&gt;Golang&lt;/td&gt;&lt;/tr&gt;&lt;tr class=&quot;css-0&quot;&gt;&lt;td class=&quot;css-15msde0&quot;&gt;&lt;a href=&quot;https://github.com/beowulfe/HAP-Java&quot; class=&quot;css-1i9b1eb&quot;&gt;beowulfe/HAP-Java&lt;/a&gt;&lt;/td&gt;&lt;td class=&quot;css-15msde0&quot;&gt;IP&lt;/td&gt;&lt;td class=&quot;css-15msde0&quot;&gt;Java&lt;/td&gt;&lt;/tr&gt;&lt;tr class=&quot;css-0&quot;&gt;&lt;td class=&quot;css-15msde0&quot;&gt;&lt;a href=&quot;https://github.com/etwmc/Personal-HomeKit-HAP&quot; class=&quot;css-1i9b1eb&quot;&gt;etwmc/Personal-HomeKit-HAP&lt;/a&gt;&lt;/td&gt;&lt;td class=&quot;css-15msde0&quot;&gt;IP&lt;/td&gt;&lt;td class=&quot;css-15msde0&quot;&gt;C++&lt;/td&gt;&lt;/tr&gt;&lt;tr class=&quot;css-0&quot;&gt;&lt;td class=&quot;css-15msde0&quot;&gt;&lt;a href=&quot;https://github.com/Bouke/HAP&quot; class=&quot;css-1i9b1eb&quot;&gt;Bouke/HAP&lt;/a&gt;&lt;/td&gt;&lt;td class=&quot;css-15msde0&quot;&gt;IP&lt;/td&gt;&lt;td class=&quot;css-15msde0&quot;&gt;Swift&lt;/td&gt;&lt;/tr&gt;&lt;tr class=&quot;css-0&quot;&gt;&lt;td class=&quot;css-15msde0&quot;&gt;&lt;a href=&quot;https://github.com/aanon4/HomeKit&quot; class=&quot;css-1i9b1eb&quot;&gt;aanon4/HomeKit&lt;/a&gt;&lt;/td&gt;&lt;td class=&quot;css-15msde0&quot;&gt;BLE&lt;/td&gt;&lt;td class=&quot;css-15msde0&quot;&gt;C++&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;p class=&quot;css-ocxwk4&quot;&gt;Of those projects, the IP-based implementations are the most mature, by far.&lt;/p&gt;&lt;h3 class=&quot;css-3omw84&quot;&gt;Network topologies&lt;/h3&gt;&lt;p class=&quot;css-ocxwk4&quot;&gt;Next, I needed to decide how the sensor values would be read using a smartphone. I considered a few network topologies (arrangements of the devices in a network):&lt;/p&gt;&lt;style data-emotion-css=&quot;1pmnorg&quot;&gt;.css-1pmnorg{font-family:inherit;font-weight:500;line-height:1.25;margin:0;margin-bottom:0.25rem;font-size:1.1rem;color:var(--theme-ui-colors-heading,#000);margin-top:1rem;}@media screen and (min-width:640px){.css-1pmnorg{font-size:1.3rem;}}@media screen and (min-width:768px){.css-1pmnorg{font-size:1.3rem;}}@media screen and (min-width:1024px){.css-1pmnorg{font-size:1.6rem;}}&lt;/style&gt;&lt;h4 class=&quot;css-1pmnorg&quot;&gt;Option 1: Arduino-based dumb sensor + wifi-connected bridge&lt;/h4&gt;&lt;p class=&quot;css-ocxwk4&quot;&gt;This option made sense because I already had an Arduino Uno, and I knew that Arduino-compatible BLE transceivers could be had for relatively cheap.&lt;/p&gt;&lt;img src=&quot;static/option1-0f9242f7ee886358fcc57c1a4651861b.svg&quot; class=&quot;css-0&quot;/&gt;&lt;style data-emotion-css=&quot;m4uvnn&quot;&gt;.css-m4uvnn{font-family:inherit;font-weight:500;line-height:1.25;margin:0;margin-bottom:0.25rem;font-size:1rem;color:var(--theme-ui-colors-heading,#000);margin-top:1rem;}@media screen and (min-width:640px){.css-m4uvnn{font-size:1.1rem;}}@media screen and (min-width:768px){.css-m4uvnn{font-size:1.1rem;}}@media screen and (min-width:1024px){.css-m4uvnn{font-size:1.3rem;}}&lt;/style&gt;&lt;h5 class=&quot;css-m4uvnn&quot;&gt;&lt;em class=&quot;css-0&quot;&gt;Evaluating Option 1&lt;/em&gt;&lt;/h5&gt;&lt;p class=&quot;css-ocxwk4&quot;&gt;One of the first things I did was to estimate the sensor&amp;#x27;s power consumption in this arrangement. Even in a low-power configuration, an &lt;a href=&quot;http://www.gammon.com.au/power&quot; class=&quot;css-1i9b1eb&quot;&gt;Arduino Uno draws about &lt;strong class=&quot;css-0&quot;&gt;35mA&lt;/strong&gt; at idle&lt;/a&gt;. With 3 × 2500mAh batteries, this would only yield us &lt;em class=&quot;css-0&quot;&gt;~1 week of battery life&lt;/em&gt;, without even considering that current would also be drawn by the BLE module and sensor. This is far from satisfying our requirement of running on batteries for at least a few months, so I was back to the drawing board.&lt;/p&gt;&lt;p class=&quot;css-ocxwk4&quot;&gt;I began to look into &lt;a href=&quot;https://www.arduino.cc/en/Main/arduinoBoardNano&quot; class=&quot;css-1i9b1eb&quot;&gt;Arduino Nano&lt;/a&gt; and even using a bare ATmega328 in an attempt to reduce power consumption. It was at this point that I discovered the &lt;a href=&quot;https://www.nordicsemi.com/eng/Products/Bluetooth-low-energy/nRF52832&quot; class=&quot;css-1i9b1eb&quot;&gt;Nordic Semiconductor nRF52832 SoC&lt;/a&gt; with an integrated BLE transceiver, with an operating current draw of about &lt;strong class=&quot;css-0&quot;&gt;50μA&lt;/strong&gt; — 3 orders of magnitude smaller than the Uno! This was a major breakthrough, since the nRF5 was capable of replacing the Arduino + BLE module combination, in a smaller package, with lower power consumption, and at a low cost. [In the next blog post, I&amp;#x27;ll discuss the nRF5 in more detail]. So I moved on to the next option, based on the nRF5.&lt;/p&gt;&lt;h4 class=&quot;css-1pmnorg&quot;&gt;Option 2: nRF-based smart sensor&lt;/h4&gt;&lt;p class=&quot;css-ocxwk4&quot;&gt;With the next solution, I attempted to simplify the system as much as possible. Having eliminated the need for a separate microcontroller (the Arduino), I wondered if I could also remove the need for a separate HomeKit BLE-to-WiFi bridge.&lt;/p&gt;&lt;img src=&quot;static/option2-1ebb0af5ab8207598bbe49c72addc803.svg&quot; class=&quot;css-0&quot;/&gt;&lt;h5 class=&quot;css-m4uvnn&quot;&gt;&lt;em class=&quot;css-0&quot;&gt;Evaluating Option 2&lt;/em&gt;&lt;/h5&gt;&lt;p class=&quot;css-ocxwk4&quot;&gt;The major issue blocking this route turned out to be an issue of &lt;strong class=&quot;css-0&quot;&gt;software&lt;/strong&gt;, i.e. the absence of a mature open-source implementation of HAP over BLE. As shown in the table above, I only found a single BLE HAP server: &lt;a href=&quot;https://github.com/aanon4/HomeKit&quot; class=&quot;css-1i9b1eb&quot;&gt;aanon4/HomeKit&lt;/a&gt;. Unfortunately, at the time of writing, it is immature, poorly documented, unmaintained, and written in C. For a hobbyist like myself, debugging issues with C code running on the nRF5 would be a significant challenge and time commitment. Therefore, this option was a no-go.&lt;/p&gt;&lt;p class=&quot;css-ocxwk4&quot;&gt;It&amp;#x27;s worth noting, though, that this is not a fundamental flaw in this topology. If this were a real product, OberonHAP could probably be used to implement HAP over BLE quite easily.&lt;/p&gt;&lt;h4 class=&quot;css-1pmnorg&quot;&gt;Option 3: nRF-based dumb sensor + wifi-connected bridge&lt;/h4&gt;&lt;p class=&quot;css-ocxwk4&quot;&gt;The final option was a combination of Option 1 and Option 2; I simply added the HAP WiFi bridge from Option 1 back into the topology of Option 2.&lt;/p&gt;&lt;img src=&quot;static/option3-df59107b2ed50a6e935d7178c3a0ab82.svg&quot; class=&quot;css-0&quot;/&gt;&lt;h5 class=&quot;css-m4uvnn&quot;&gt;&lt;em class=&quot;css-0&quot;&gt;Evaluating Option 3&lt;/em&gt;&lt;/h5&gt;&lt;p class=&quot;css-ocxwk4&quot;&gt;With this option, I was able to maintain the improved sensor power consumption characteristics from Option 2, while overcoming the HAP server software roadblock. This option seemed to finally be a path to a viable solution. Success!&lt;/p&gt;&lt;h2 class=&quot;css-992wu8&quot;&gt;Conclusion and Next Steps&lt;/h2&gt;&lt;p class=&quot;css-ocxwk4&quot;&gt;Having chosen a workable high-level design and network topology, the next steps were to:&lt;/p&gt;&lt;ul class=&quot;css-aq9zkf&quot;&gt;&lt;li class=&quot;css-0&quot;&gt;Implement BLE sensor value broadcasting on the nRF5&lt;/li&gt;&lt;li class=&quot;css-0&quot;&gt;Implement a BLE ⟷ HAP-over-IP sensor bridge&lt;/li&gt;&lt;/ul&gt;&lt;p class=&quot;css-ocxwk4&quot;&gt;In the next post, I&amp;#x27;ll discuss the hardware used in this project, and we&amp;#x27;ll get into the BLE sensor broadcasting implementation.&lt;/p&gt;&lt;h5 class=&quot;css-m4uvnn&quot;&gt;See what happens next in &lt;a href=&quot;/blog/ble-homekit-sensor-pt2&quot; class=&quot;css-1i9b1eb&quot;&gt;Part 2&lt;/a&gt;!&lt;/h5&gt;</content:encoded></item><item><title><![CDATA[Hello world from my new blog!]]></title><link>https://dgross.ca/blog/hello-world</link><guid isPermaLink="false">https://dgross.ca/blog/hello-world</guid><pubDate>Thu, 09 Mar 2017 05:00:00 GMT</pubDate><content:encoded>&lt;style data-emotion-css=&quot;9096aj&quot;&gt;body{--theme-ui-colors-transparent:var(--theme-ui-colors-transparent,transparent);--theme-ui-colors-black:var(--theme-ui-colors-black,#000);--theme-ui-colors-white:var(--theme-ui-colors-white,#fff);--theme-ui-colors-gray-0:var(--theme-ui-colors-gray-0,null);--theme-ui-colors-gray-1:var(--theme-ui-colors-gray-1,#f7fafc);--theme-ui-colors-gray-2:var(--theme-ui-colors-gray-2,#edf2f7);--theme-ui-colors-gray-3:var(--theme-ui-colors-gray-3,#e2e8f0);--theme-ui-colors-gray-4:var(--theme-ui-colors-gray-4,#cbd5e0);--theme-ui-colors-gray-5:var(--theme-ui-colors-gray-5,#a0aec0);--theme-ui-colors-gray-6:var(--theme-ui-colors-gray-6,#718096);--theme-ui-colors-gray-7:var(--theme-ui-colors-gray-7,#4a5568);--theme-ui-colors-gray-8:var(--theme-ui-colors-gray-8,#2d3748);--theme-ui-colors-gray-9:var(--theme-ui-colors-gray-9,#1a202c);--theme-ui-colors-red-0:var(--theme-ui-colors-red-0,null);--theme-ui-colors-red-1:var(--theme-ui-colors-red-1,#fff5f5);--theme-ui-colors-red-2:var(--theme-ui-colors-red-2,#fed7d7);--theme-ui-colors-red-3:var(--theme-ui-colors-red-3,#feb2b2);--theme-ui-colors-red-4:var(--theme-ui-colors-red-4,#fc8181);--theme-ui-colors-red-5:var(--theme-ui-colors-red-5,#f56565);--theme-ui-colors-red-6:var(--theme-ui-colors-red-6,#e53e3e);--theme-ui-colors-red-7:var(--theme-ui-colors-red-7,#c53030);--theme-ui-colors-red-8:var(--theme-ui-colors-red-8,#9b2c2c);--theme-ui-colors-red-9:var(--theme-ui-colors-red-9,#742a2a);--theme-ui-colors-orange-0:var(--theme-ui-colors-orange-0,null);--theme-ui-colors-orange-1:var(--theme-ui-colors-orange-1,#fffaf0);--theme-ui-colors-orange-2:var(--theme-ui-colors-orange-2,#feebc8);--theme-ui-colors-orange-3:var(--theme-ui-colors-orange-3,#fbd38d);--theme-ui-colors-orange-4:var(--theme-ui-colors-orange-4,#f6ad55);--theme-ui-colors-orange-5:var(--theme-ui-colors-orange-5,#ed8936);--theme-ui-colors-orange-6:var(--theme-ui-colors-orange-6,#dd6b20);--theme-ui-colors-orange-7:var(--theme-ui-colors-orange-7,#c05621);--theme-ui-colors-orange-8:var(--theme-ui-colors-orange-8,#9c4221);--theme-ui-colors-orange-9:var(--theme-ui-colors-orange-9,#7b341e);--theme-ui-colors-yellow-0:var(--theme-ui-colors-yellow-0,null);--theme-ui-colors-yellow-1:var(--theme-ui-colors-yellow-1,#fffff0);--theme-ui-colors-yellow-2:var(--theme-ui-colors-yellow-2,#fefcbf);--theme-ui-colors-yellow-3:var(--theme-ui-colors-yellow-3,#faf089);--theme-ui-colors-yellow-4:var(--theme-ui-colors-yellow-4,#f6e05e);--theme-ui-colors-yellow-5:var(--theme-ui-colors-yellow-5,#ecc94b);--theme-ui-colors-yellow-6:var(--theme-ui-colors-yellow-6,#d69e2e);--theme-ui-colors-yellow-7:var(--theme-ui-colors-yellow-7,#b7791f);--theme-ui-colors-yellow-8:var(--theme-ui-colors-yellow-8,#975a16);--theme-ui-colors-yellow-9:var(--theme-ui-colors-yellow-9,#744210);--theme-ui-colors-green-0:var(--theme-ui-colors-green-0,null);--theme-ui-colors-green-1:var(--theme-ui-colors-green-1,#f0fff4);--theme-ui-colors-green-2:var(--theme-ui-colors-green-2,#c6f6d5);--theme-ui-colors-green-3:var(--theme-ui-colors-green-3,#9ae6b4);--theme-ui-colors-green-4:var(--theme-ui-colors-green-4,#68d391);--theme-ui-colors-green-5:var(--theme-ui-colors-green-5,#48bb78);--theme-ui-colors-green-6:var(--theme-ui-colors-green-6,#38a169);--theme-ui-colors-green-7:var(--theme-ui-colors-green-7,#2f855a);--theme-ui-colors-green-8:var(--theme-ui-colors-green-8,#276749);--theme-ui-colors-green-9:var(--theme-ui-colors-green-9,#22543d);--theme-ui-colors-teal-0:var(--theme-ui-colors-teal-0,null);--theme-ui-colors-teal-1:var(--theme-ui-colors-teal-1,#e6fffa);--theme-ui-colors-teal-2:var(--theme-ui-colors-teal-2,#b2f5ea);--theme-ui-colors-teal-3:var(--theme-ui-colors-teal-3,#81e6d9);--theme-ui-colors-teal-4:var(--theme-ui-colors-teal-4,#4fd1c5);--theme-ui-colors-teal-5:var(--theme-ui-colors-teal-5,#38b2ac);--theme-ui-colors-teal-6:var(--theme-ui-colors-teal-6,#319795);--theme-ui-colors-teal-7:var(--theme-ui-colors-teal-7,#2c7a7b);--theme-ui-colors-teal-8:var(--theme-ui-colors-teal-8,#285e61);--theme-ui-colors-teal-9:var(--theme-ui-colors-teal-9,#234e52);--theme-ui-colors-blue-0:var(--theme-ui-colors-blue-0,null);--theme-ui-colors-blue-1:var(--theme-ui-colors-blue-1,#ebf8ff);--theme-ui-colors-blue-2:var(--theme-ui-colors-blue-2,#bee3f8);--theme-ui-colors-blue-3:var(--theme-ui-colors-blue-3,#90cdf4);--theme-ui-colors-blue-4:var(--theme-ui-colors-blue-4,#63b3ed);--theme-ui-colors-blue-5:var(--theme-ui-colors-blue-5,#4299e1);--theme-ui-colors-blue-6:var(--theme-ui-colors-blue-6,#3182ce);--theme-ui-colors-blue-7:var(--theme-ui-colors-blue-7,#2b6cb0);--theme-ui-colors-blue-8:var(--theme-ui-colors-blue-8,#2c5282);--theme-ui-colors-blue-9:var(--theme-ui-colors-blue-9,#2a4365);--theme-ui-colors-indigo-0:var(--theme-ui-colors-indigo-0,null);--theme-ui-colors-indigo-1:var(--theme-ui-colors-indigo-1,#ebf4ff);--theme-ui-colors-indigo-2:var(--theme-ui-colors-indigo-2,#c3dafe);--theme-ui-colors-indigo-3:var(--theme-ui-colors-indigo-3,#a3bffa);--theme-ui-colors-indigo-4:var(--theme-ui-colors-indigo-4,#7f9cf5);--theme-ui-colors-indigo-5:var(--theme-ui-colors-indigo-5,#667eea);--theme-ui-colors-indigo-6:var(--theme-ui-colors-indigo-6,#5a67d8);--theme-ui-colors-indigo-7:var(--theme-ui-colors-indigo-7,#4c51bf);--theme-ui-colors-indigo-8:var(--theme-ui-colors-indigo-8,#434190);--theme-ui-colors-indigo-9:var(--theme-ui-colors-indigo-9,#3c366b);--theme-ui-colors-purple-0:var(--theme-ui-colors-purple-0,null);--theme-ui-colors-purple-1:var(--theme-ui-colors-purple-1,#faf5ff);--theme-ui-colors-purple-2:var(--theme-ui-colors-purple-2,#e9d8fd);--theme-ui-colors-purple-3:var(--theme-ui-colors-purple-3,#d6bcfa);--theme-ui-colors-purple-4:var(--theme-ui-colors-purple-4,#b794f4);--theme-ui-colors-purple-5:var(--theme-ui-colors-purple-5,#9f7aea);--theme-ui-colors-purple-6:var(--theme-ui-colors-purple-6,#805ad5);--theme-ui-colors-purple-7:var(--theme-ui-colors-purple-7,#6b46c1);--theme-ui-colors-purple-8:var(--theme-ui-colors-purple-8,#553c9a);--theme-ui-colors-purple-9:var(--theme-ui-colors-purple-9,#44337a);--theme-ui-colors-pink-0:var(--theme-ui-colors-pink-0,null);--theme-ui-colors-pink-1:var(--theme-ui-colors-pink-1,#fff5f7);--theme-ui-colors-pink-2:var(--theme-ui-colors-pink-2,#fed7e2);--theme-ui-colors-pink-3:var(--theme-ui-colors-pink-3,#fbb6ce);--theme-ui-colors-pink-4:var(--theme-ui-colors-pink-4,#f687b3);--theme-ui-colors-pink-5:var(--theme-ui-colors-pink-5,#ed64a6);--theme-ui-colors-pink-6:var(--theme-ui-colors-pink-6,#d53f8c);--theme-ui-colors-pink-7:var(--theme-ui-colors-pink-7,#b83280);--theme-ui-colors-pink-8:var(--theme-ui-colors-pink-8,#97266d);--theme-ui-colors-pink-9:var(--theme-ui-colors-pink-9,#702459);--theme-ui-colors-grayDark:var(--theme-ui-colors-grayDark,#2d3748);--theme-ui-colors-text:var(--theme-ui-colors-text,#2d3748);--theme-ui-colors-background:var(--theme-ui-colors-background,#fff);--theme-ui-colors-primary:var(--theme-ui-colors-primary,#2b6cb0);--theme-ui-colors-primaryHover:var(--theme-ui-colors-primaryHover,#2c5282);--theme-ui-colors-secondary:var(--theme-ui-colors-secondary,#718096);--theme-ui-colors-muted:var(--theme-ui-colors-muted,#e2e8f0);--theme-ui-colors-success:var(--theme-ui-colors-success,#9ae6b4);--theme-ui-colors-info:var(--theme-ui-colors-info,#63b3ed);--theme-ui-colors-warning:var(--theme-ui-colors-warning,#faf089);--theme-ui-colors-danger:var(--theme-ui-colors-danger,#feb2b2);--theme-ui-colors-light:var(--theme-ui-colors-light,#f7fafc);--theme-ui-colors-dark:var(--theme-ui-colors-dark,#2d3748);--theme-ui-colors-textMuted:var(--theme-ui-colors-textMuted,#718096);--theme-ui-colors-toggleIcon:var(--theme-ui-colors-toggleIcon,#2d3748);--theme-ui-colors-heading:var(--theme-ui-colors-heading,#000);--theme-ui-colors-divide:var(--theme-ui-colors-divide,#cbd5e0);color:var(--theme-ui-colors-text,#2d3748);background-color:var(--theme-ui-colors-background,#fff);}body.theme-ui-dark{--theme-ui-colors-text:var(--theme-ui-colors-modes-dark-text,#cbd5e0);--theme-ui-colors-primary:var(--theme-ui-colors-modes-dark-primary,#63b3ed);--theme-ui-colors-secondary:var(--theme-ui-colors-modes-dark-secondary,#7f8ea3);--theme-ui-colors-toggleIcon:var(--theme-ui-colors-modes-dark-toggleIcon,#cbd5e0);--theme-ui-colors-background:var(--theme-ui-colors-modes-dark-background,#1A202C);--theme-ui-colors-heading:var(--theme-ui-colors-modes-dark-heading,#fff);--theme-ui-colors-divide:var(--theme-ui-colors-modes-dark-divide,#2d3748);--theme-ui-colors-muted:var(--theme-ui-colors-modes-dark-muted,#2d3748);}&lt;/style&gt;&lt;style data-emotion-css=&quot;tm2q0o&quot;&gt;*{box-sizing:border-box;}body{margin:0;font-family:&quot;IBM Plex Sans&quot;,-apple-system,BlinkMacSystemFont,&quot;Segoe UI&quot;,Roboto,&quot;Helvetica Neue&quot;,Arial,&quot;Noto Sans&quot;,sans-serif,&quot;Apple Color Emoji&quot;,&quot;Segoe UI Emoji&quot;,&quot;Segoe UI Symbol&quot;,&quot;Noto Color Emoji&quot;;line-height:1.625;font-weight:400;color:var(--theme-ui-colors-text,#2d3748);background-color:var(--theme-ui-colors-background,#fff);padding:0;box-sizing:border-box;text-rendering:optimizeLegibility;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;}&lt;/style&gt;&lt;style data-emotion-css=&quot;ocxwk4&quot;&gt;.css-ocxwk4{font-size:1rem;-webkit-letter-spacing:-0.003em;-moz-letter-spacing:-0.003em;-ms-letter-spacing:-0.003em;letter-spacing:-0.003em;line-height:1.625;--baseline-multiplier:0.179;--x-height-multiplier:0.35;word-break:break-word;}@media screen and (min-width:640px){.css-ocxwk4{font-size:1rem;}}@media screen and (min-width:768px){.css-ocxwk4{font-size:1.1rem;}}&lt;/style&gt;&lt;p class=&quot;css-ocxwk4&quot;&gt;Welcome to my blog! I&amp;#x27;ll be using this space to publish thoughts on various topics. Stay tuned.&lt;/p&gt;</content:encoded></item></channel></rss>